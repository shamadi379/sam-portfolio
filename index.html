<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- GitHub Pages Force Deploy: October 8 2025 -->
    <title>Sam in Cloud | Cloud Solutions Specialist</title>
    
    <!-- Security Headers -->
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
    <meta name="description" content="Cloud Solutions Specialist with expertise in Microsoft 365, Azure, Intune, and Exchange. Professional Microsoft cloud services for small to medium businesses.">
    <meta name="robots" content="index, follow">
    <meta name="author" content="Sam Adhikari">
    <meta name="keywords" content="cloud, azure, microsoft 365, intune, exchange, powershell, automation, security, cloud specialist">
    
    <!-- Open Graph Meta Tags for Social Media -->
    <meta property="og:title" content="Sam in Cloud | Cloud Solutions Specialist">
    <meta property="og:description" content="Expert in Microsoft 365, Azure, Intune, and Exchange. Practical automation tutorials and security best practices for cloud professionals.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://samincloud.com/">
    <meta property="og:site_name" content="Sam in Cloud">
    <meta property="og:image" content="https://samincloud.com/images/sam-cloud-logo-og.svg">
    <meta property="og:image:type" content="image/svg+xml">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="Sam in Cloud - Cloud Solutions Specialist Logo">
    <meta property="og:locale" content="en_US">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@samincloud">
    <meta name="twitter:creator" content="@samincloud">
    <meta name="twitter:title" content="Sam in Cloud | Cloud Solutions Specialist">
    <meta name="twitter:description" content="Expert in Microsoft 365, Azure, Intune, and Exchange. Practical automation tutorials and security best practices.">
    <meta name="twitter:image" content="https://samincloud.com/images/sam-cloud-logo-og.svg">
    <meta name="twitter:image:alt" content="Sam in Cloud - Cloud Solutions Specialist">
    
    <!-- Additional Social Media Meta Tags -->
    <meta property="article:author" content="Sam Adhikari">
    <meta name="format-detection" content="telephone=no">
    <meta name="twitter:image:alt" content="Sam in Cloud - Cloud Solutions Specialist">
    
    <!-- Additional SEO Meta Tags -->
    <meta name="theme-color" content="#10b981">
    <link rel="canonical" href="https://samincloud.com">
    <link rel="manifest" href="/manifest.json">
    
    <!-- Comprehensive Favicon Setup (like Reddit/Google) -->
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="icon" type="image/svg+xml" sizes="16x16" href="favicon-16x16.svg">
    <link rel="icon" type="image/svg+xml" sizes="32x32" href="favicon.svg">
    <link rel="icon" type="image/svg+xml" sizes="48x48" href="favicon.svg">
    
    <!-- Fallback for browsers that don't support SVG favicons -->
    <link rel="alternate icon" type="image/svg+xml" href="favicon.svg">
    
    <!-- Apple Touch Icons -->
    <link rel="apple-touch-icon" sizes="180x180" href="favicon.svg">
    <link rel="apple-touch-icon" sizes="152x152" href="favicon.svg">
    <link rel="apple-touch-icon" sizes="144x144" href="favicon.svg">
    <link rel="apple-touch-icon" sizes="120x120" href="favicon.svg">
    <link rel="apple-touch-icon" sizes="76x76" href="favicon.svg">
    
    <!-- Microsoft Tiles -->
    <meta name="msapplication-TileColor" content="#10b981">
    <meta name="msapplication-TileImage" content="favicon.svg">
    <meta name="theme-color" content="#10b981">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/feather-icons"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap');
        
        /* Remove Unsplash dependency - use gradient background instead */
        body {
            font-family: 'Poppins', sans-serif;
            scroll-behavior: smooth;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%);
        }
        
        /* Theme variables */
        :root{
            --accent-emerald: #047857;
            --accent-emerald-600: rgba(4,120,87,0.9);
            --surface-white: rgba(255,255,255,0.96);
            --panel-gray: rgba(255,255,255,0.06);
            --muted-text: #94a3b8;
        }
        
        /* Favicon optimization for browser tab display */
        link[rel="icon"] {
            background-color: transparent;
        }
        
        /* Enhanced background - copyright-safe gradient */
        .site-bg {
            background: linear-gradient(135deg, 
                rgba(16, 185, 129, 0.1) 0%, 
                rgba(59, 130, 246, 0.1) 50%,
                rgba(15, 23, 42, 0.2) 100%),
                linear-gradient(45deg, #0f172a, #1e293b, #334155);
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
        }
        
        /* Smooth transitions for all interactive elements */
        * {
            transition: all 0.2s ease-in-out;
        }
        
        /* Enhanced hover effects */
        .skill-badge {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .skill-badge:hover {
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        /* Smooth scroll enhancement */
        html {
            scroll-padding-top: 5rem;
        }
        
        /* Enhanced card shadows */
        .card-surface{
            background: white;
            color: #0f172a;
            border-radius: 0.75rem;
            padding: 1rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .card-surface:hover {
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        
        /* Brand styling */
        .site-brand {
            white-space: nowrap;
            display: inline-block;
        }
        
        /* Logo animations */
        .logo-container svg {
            filter: drop-shadow(0 4px 12px rgba(16, 185, 129, 0.4));
            transition: all 0.3s ease;
        }
        
        .logo-hero svg {
            filter: drop-shadow(0 8px 16px rgba(16, 185, 129, 0.4));
        }
        
        /* Enhanced logo hover effects */
        .logo-container:hover svg,
        .logo-hero:hover svg {
            animation: logoFloat 2s ease-in-out infinite;
            filter: drop-shadow(0 6px 16px rgba(16, 185, 129, 0.6));
        }
        
        /* Brand enhancement */
        .site-brand {
            padding: 8px 0;
        }
        
        .site-brand:hover .logo-container svg {
            transform: scale(1.1);
        }
        
        @keyframes logoFloat {
            0%, 100% { transform: translateY(0px) scale(1.1); }
            50% { transform: translateY(-6px) scale(1.15); }
        }
        
        /* Mobile logo adjustments */
        @media (max-width: 768px) {
            .logo-container svg {
                width: 56px;
                height: 56px;
            }
            
            .site-brand span {
                font-size: 1.375rem; /* text-xl equivalent for mobile */
            }
            
            .logo-hero svg {
                width: 72px;
                height: 64px;
            }
        }
        
        @media (max-width: 480px) {
            .logo-container svg {
                width: 48px;
                height: 48px;
            }
            
            .site-brand span {
                font-size: 1.25rem; /* text-lg for very small screens */
            }
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
        
        /* Enhanced button styles */
        .btn-primary {
            background: linear-gradient(135deg, #059669 0%, #047857 100%);
            box-shadow: 0 4px 14px 0 rgba(16, 185, 129, 0.39);
            transition: all 0.3s ease;
        }
        
        .btn-primary:hover {
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.4);
            transform: translateY(-2px);
        }
        
        /* Loading animation for images */
        img {
            transition: opacity 0.3s ease;
        }
        
        /* Focus styles for accessibility */
        button:focus,
        input:focus,
        textarea:focus,
        a:focus {
            outline: 2px solid #10b981;
            outline-offset: 2px;
        }
        
        /* Subtle fade-in animation for sections */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        section {
            animation: fadeInUp 0.6s ease-out;
        }
        
        /* Enhanced backdrop blur for better readability */
        .backdrop-blur-enhanced {
            backdrop-filter: blur(16px) saturate(180%);
            -webkit-backdrop-filter: blur(16px) saturate(180%);
        }
        
        /* Microsoft Hub Styles */
        .hub-card {
            background: white;
            border-radius: 1rem;
            padding: 1.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid rgba(59, 130, 246, 0.1);
        }

        .hub-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            border-color: rgba(59, 130, 246, 0.2);
        }

        .hub-card-source {
            display: inline-block;
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 0.375rem;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .hub-card-title {
            font-size: 1.125rem;
            font-weight: 700;
            color: #1f2937;
            margin: 1rem 0 0.5rem 0;
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .hub-card-excerpt {
            color: #6b7280;
            font-size: 0.875rem;
            line-height: 1.5;
            display: -webkit-box;
            -webkit-line-clamp: 3;
            line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
            margin-bottom: 1rem;
        }

        .hub-card-meta {
            display: flex;
            align-items: center;
            justify-content: space-between;
            font-size: 0.75rem;
            color: #9ca3af;
        }

        .hub-refresh-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid rgba(59, 130, 246, 0.2);
            color: #3b82f6;
            padding: 0.5rem;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .hub-refresh-btn:hover {
            background: rgba(59, 130, 246, 0.2);
            transform: rotate(180deg);
        }

        /* Category Tabs */
        .category-tab {
            padding: 0.75rem 1.5rem;
            border-radius: 0.75rem;
            background: white;
            border: 2px solid rgba(59, 130, 246, 0.2);
            color: #3b82f6;
            font-weight: 600;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .category-tab:hover {
            background: rgba(59, 130, 246, 0.1);
            border-color: rgba(59, 130, 246, 0.4);
        }

        .category-tab.active {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            color: white;
            border-color: #1d4ed8;
        }

        /* Tool Links */
        .tool-link {
            display: block;
            padding: 1rem;
            border-radius: 1rem;
            transition: all 0.3s ease;
            text-decoration: none;
        }

        .tool-link:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        /* Enhanced Hub Cards with Categories */
        .hub-card[data-category] {
            position: relative;
        }

        .hub-card.hidden-category {
            display: none;
        }

        .hub-card-category-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 0.5rem;
            font-size: 0.625rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* Search Results Highlighting */
        .search-highlight {
            background: yellow;
            font-weight: bold;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .category-tab {
                padding: 0.5rem 1rem;
                font-size: 0.875rem;
            }
        }
    </style>
</head>
<body class="site-bg">
    <!-- overlay removed to avoid dimming content — contrast handled per-section -->
    <!-- Background animation removed per user request -->
    
    <!-- Navigation -->
    <nav class="bg-emerald-800/90 backdrop-blur-lg fixed w-full z-10 shadow-lg border-b border-emerald-700/20">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-20 items-center">
                <!-- left: brand + primary links -->
                <div class="flex items-center space-x-8">
                    <div class="site-brand flex items-center space-x-3">
                        <div class="logo-container">
                            <svg width="64" height="64" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg" class="transition-transform duration-300 hover:scale-110">
                                <!-- Cloud background -->
                                <defs>
                                    <linearGradient id="cloudGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                        <stop offset="0%" style="stop-color:#10b981;stop-opacity:1" />
                                        <stop offset="100%" style="stop-color:#059669;stop-opacity:1" />
                                    </linearGradient>
                                    <linearGradient id="letterGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                                        <stop offset="0%" style="stop-color:#ffffff;stop-opacity:1" />
                                        <stop offset="100%" style="stop-color:#f0fdf4;stop-opacity:1" />
                                    </linearGradient>
                                </defs>
                                
                                <!-- Cloud shape -->
                                <path d="M32 24c1.5 0 3-1 3-3 0-3-2.5-5.5-5.5-5.5-.5-3-3-5.5-6.5-5.5-2.5 0-4.5 1.5-5.5 3.5-1-.5-2-.5-3 0C13 15 12 17 12 19c-2 0-4 2-4 4s2 4 4 4h20z" 
                                      fill="url(#cloudGradient)" 
                                      stroke="#047857" 
                                      stroke-width="1"/>
                                
                                <!-- Letter "S" -->
                                <path d="M18 18c0-1 1-2 2-2h2c1 0 2 1 2 2s-1 2-2 2h-2c-1 0-2 1-2 2s1 2 2 2h2c1 0 2-1 2-2" 
                                      fill="none" 
                                      stroke="url(#letterGradient)" 
                                      stroke-width="2.5" 
                                      stroke-linecap="round"/>
                                
                                <!-- Subtle glow effect -->
                                <circle cx="20" cy="20" r="18" fill="none" stroke="rgba(16,185,129,0.3)" stroke-width="1" opacity="0.5"/>
                            </svg>
                        </div>
                        <span class="text-2xl font-bold text-white tracking-tight hover:text-emerald-100 transition-colors duration-300">Sam in Cloud</span>
                    </div>
                    <div class="hidden md:flex items-center space-x-6">
                        <a href="#home" class="text-emerald-100 hover:text-white transition-colors duration-200 font-medium">Home</a>
                        <a href="#about" class="text-emerald-100 hover:text-white transition-colors duration-200 font-medium">About</a>
                        <a href="#services" class="text-emerald-100 hover:text-white transition-colors duration-200 font-medium">Services</a>
                        <a href="#contact" class="text-emerald-100 hover:text-white transition-colors duration-200 font-medium">Contact</a>
                        <a href="#it-news" class="text-emerald-100 hover:text-white transition-colors duration-200 font-medium">IT News</a>
                    </div>
                </div>

                <!-- right: contact -->
                <div class="hidden md:flex items-center">
                    <button onclick="openITChatbot()" class="bg-gradient-to-r from-emerald-600 to-emerald-700 hover:from-emerald-700 hover:to-emerald-800 text-white px-6 py-2.5 rounded-lg font-semibold transition-all duration-200 shadow-md hover:shadow-lg transform hover:-translate-y-0.5 flex items-center gap-2 relative overflow-hidden group">
                        <i data-feather="zap" class="w-4 h-4"></i>
                        <span id="help-button-text">Quick IT Help</span>
                        <div class="absolute inset-0 bg-white/10 translate-x-full group-hover:translate-x-0 transition-transform duration-300"></div>
                    </button>
                </div>

                <!-- mobile menu button -->
                <div class="md:hidden flex items-center">
                    <button id="menu-btn" class="text-white hover:text-emerald-200 transition-colors">
                        <i data-feather="menu" class="w-6 h-6"></i>
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Top About Panel (hidden by default) -->
    <div id="about-panel" class="hidden fixed inset-x-4 top-20 z-20 max-w-6xl mx-auto bg-white/98 backdrop-blur-xl border border-emerald-200/50 rounded-2xl shadow-2xl overflow-hidden">
        <div class="p-6 border-b border-gray-200/70 bg-gradient-to-r from-emerald-50 to-blue-50">
            <div class="flex justify-between items-center">
                <h2 class="text-3xl font-bold text-gray-800">About Sam</h2>
                <button id="close-about-panel" class="text-gray-600 hover:text-gray-800 transition-colors p-2 rounded-lg hover:bg-gray-100">
                    <i data-feather="x" class="w-5 h-5"></i>
                </button>
            </div>
        </div>
        
        <div class="p-6 max-h-[70vh] overflow-y-auto bg-white">
            <div class="grid md:grid-cols-2 gap-8">
                <!-- Left Column -->
                <div class="space-y-6">
                    <!-- Professional Summary -->
                    <div>
                        <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                            <i data-feather="user" class="w-5 h-5 text-emerald-600"></i>
                            Professional Summary
                        </h3>
                        <p class="text-gray-800 leading-relaxed font-medium">Cloud Solutions Specialist with over 4 years of progressive experience in system administration and technical support, backed by a bachelor's degree in information technology. Highly skilled in managing enterprise systems, deploying cloud solutions, and supporting IT infrastructure across multiple sites.</p>
                        <p class="text-gray-800 leading-relaxed mt-3 font-medium">Known for troubleshooting complex issues, improving system efficiency through automation, and working independently under pressure.</p>
                    </div>

                    <!-- Experience -->
                    <div>
                        <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                            <i data-feather="briefcase" class="w-5 h-5 text-emerald-600"></i>
                            Experience
                        </h3>
                        <div class="space-y-4">
                            <div class="border-l-4 border-emerald-500 pl-4 bg-emerald-50 p-4 rounded-r-lg">
                                <h4 class="font-bold text-gray-800">System Administrator</h4>
                                <p class="text-emerald-700 text-sm font-semibold">Atlantic Digital • Sept 2025 – Present</p>
                                <p class="text-gray-700 text-sm mt-1 font-medium">Primary escalation point managing Veeam backups, Windows Server estate, Azure security posture and ISO-aligned controls.</p>
                            </div>
                            <div class="border-l-4 border-blue-500 pl-4 bg-blue-50 p-4 rounded-r-lg">
                                <h4 class="font-bold text-gray-800">System Engineer</h4>
                                <p class="text-blue-700 text-sm font-semibold">Barnardos Australia • July 2024 – Sept 2025</p>
                                <p class="text-gray-700 text-sm mt-1 font-medium">Managed IT infrastructure, Intune compliance, automation with Power Automate, and network monitoring.</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right Column -->
                <div class="space-y-6">
                    <!-- Technical Skills -->
                    <div>
                        <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                            <i data-feather="cpu" class="w-5 h-5 text-emerald-600"></i>
                            Technical Skills
                        </h3>
                        <div class="grid grid-cols-1 gap-3">
                            <div class="flex flex-wrap gap-2">
                                <span class="px-3 py-2 bg-blue-100 text-blue-900 rounded-full text-xs font-bold border border-blue-200">Azure AD / Entra ID</span>
                                <span class="px-3 py-2 bg-blue-100 text-blue-900 rounded-full text-xs font-bold border border-blue-200">Azure ARM</span>
                                <span class="px-3 py-2 bg-blue-100 text-blue-900 rounded-full text-xs font-bold border border-blue-200">RBAC</span>
                                <span class="px-3 py-2 bg-blue-100 text-blue-900 rounded-full text-xs font-bold border border-blue-200">Azure VNet</span>
                                <span class="px-3 py-2 bg-blue-100 text-blue-900 rounded-full text-xs font-bold border border-blue-200">Virtual Machines</span>
                                <span class="px-3 py-2 bg-blue-100 text-blue-900 rounded-full text-xs font-bold border border-blue-200">Azure Monitor</span>
                                <span class="px-3 py-2 bg-blue-100 text-blue-900 rounded-full text-xs font-bold border border-blue-200">Azure Policy</span>
                                <span class="px-3 py-2 bg-blue-100 text-blue-900 rounded-full text-xs font-bold border border-blue-200">Site Recovery</span>
                                <span class="px-3 py-2 bg-blue-100 text-blue-900 rounded-full text-xs font-bold border border-blue-200">Azure Networking</span>
                                <span class="px-3 py-2 bg-blue-100 text-blue-900 rounded-full text-xs font-bold border border-blue-200">Identity Management</span>
                                <span class="px-3 py-2 bg-purple-100 text-purple-900 rounded-full text-xs font-bold border border-purple-200">PowerShell</span>
                                <span class="px-3 py-2 bg-purple-100 text-purple-900 rounded-full text-xs font-bold border border-purple-200">Azure Automation</span>
                                <span class="px-3 py-2 bg-green-100 text-green-900 rounded-full text-xs font-bold border border-green-200">Key Vault</span>
                                <span class="px-3 py-2 bg-green-100 text-green-900 rounded-full text-xs font-bold border border-green-200">Azure Firewall</span>
                                <span class="px-3 py-2 bg-green-100 text-green-900 rounded-full text-xs font-bold border border-green-200">Blob Storage</span>
                            </div>
                        </div>
                    </div>

                    <!-- Education & Certifications -->
                    <div>
                        <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                            <i data-feather="award" class="w-5 h-5 text-emerald-600"></i>
                            Education & Certifications
                        </h3>
                        <div class="space-y-3">
                            <div class="p-4 bg-gray-100 rounded-lg border-2 border-gray-200">
                                <h4 class="font-bold text-gray-800">Bachelor of Information Technology</h4>
                                <p class="text-gray-700 text-sm font-medium">Kings Own Institute, Sydney</p>
                            </div>
                            <div class="p-4 bg-emerald-100 rounded-lg border-2 border-emerald-300">
                                <h4 class="font-bold text-gray-800">Microsoft Certified</h4>
                                <p class="text-gray-700 text-sm font-medium">Azure Fundamentals • Azure Administrator</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile Menu -->
    <div id="mobile-menu" class="hidden fixed inset-0 bg-emerald-900/95 backdrop-blur-lg z-20 pt-20 px-6">
        <div class="flex flex-col items-center space-y-8 text-center max-w-sm mx-auto">
            <a href="#home" class="text-2xl text-white hover:text-emerald-200 transition-colors duration-200 font-medium py-2">Home</a>
            <a href="#about" class="text-2xl text-white hover:text-emerald-200 transition-colors duration-200 font-medium py-2">About</a>
            <a href="#services" class="text-2xl text-white hover:text-emerald-200 transition-colors duration-200 font-medium py-2">Services</a>
            <a href="#it-news" class="text-2xl text-white hover:text-emerald-200 transition-colors duration-200 font-medium py-2">IT News</a>
            <button onclick="openITChatbot()" class="bg-gradient-to-r from-emerald-600 to-emerald-700 hover:from-emerald-700 hover:to-emerald-800 text-white px-8 py-4 rounded-lg font-semibold transition-all duration-200 shadow-lg w-full text-center flex items-center justify-center gap-2 relative overflow-hidden group">
                <i data-feather="zap" class="w-5 h-5"></i>
                <span id="mobile-help-button-text">Quick IT Help</span>
                <div class="absolute inset-0 bg-white/10 translate-x-full group-hover:translate-x-0 transition-transform duration-300"></div>
            </button>
            <button id="close-menu" class="absolute top-6 right-6 text-white hover:text-emerald-200 transition-colors">
                <i data-feather="x" class="w-7 h-7"></i>
            </button>
        </div>
    </div>

    <!-- Hero Section -->
    <section id="home" class="relative pt-32 pb-24 px-4 sm:px-6 lg:px-8">
        <!-- Background overlay for better text readability -->
        <div class="absolute inset-0 bg-black/40 backdrop-blur-sm"></div>
        <div class="max-w-6xl mx-auto relative z-10">
            <div class="flex flex-col md:flex-row items-center gap-12">
                <div class="md:w-2/5 flex justify-center">
                    <div class="relative">
                        <img src="images/IMG_2391.jpg" alt="Sam Adhikari" class="rounded-full w-56 h-56 md:w-72 md:h-72 object-cover border-4 border-white/20 shadow-2xl">
                        <div class="absolute inset-0 rounded-full bg-emerald-500/10 animate-pulse"></div>
                    </div>
                </div>
                <div class="md:w-3/5 text-center md:text-left space-y-6">
                    <div>
                        <h1 class="text-5xl md:text-6xl font-bold text-white mb-3 leading-tight drop-shadow-lg">Sam Adhikari</h1>
                        <h2 class="text-2xl md:text-3xl text-emerald-200 font-medium drop-shadow-md">Cloud Solutions Specialist</h2>
                    </div>
                    <p class="text-lg text-white font-semibold leading-relaxed max-w-2xl drop-shadow-md">
                        Transform your business with expert Microsoft 365, Azure, and Intune solutions. Practical automation and security for small to medium businesses.
                    </p>
                    <div class="flex flex-wrap justify-center md:justify-start gap-4 pt-4">
                        <a href="#services" class="bg-emerald-600 hover:bg-emerald-700 text-white px-8 py-4 rounded-lg font-semibold transition-all duration-300 flex items-center gap-3 shadow-lg hover:shadow-xl transform hover:-translate-y-1">
                            <i data-feather="briefcase" class="w-5 h-5"></i> 
                            View My Services
                        </a>
                        <a href="#contact" class="bg-white/20 hover:bg-white/30 backdrop-blur-sm text-white px-8 py-4 rounded-lg font-semibold transition-all duration-300 flex items-center gap-3 border border-white/30 hover:border-white/50">
                            <i data-feather="phone" class="w-5 h-5"></i> 
                            Free Consultation
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>

        <!-- IT News & Updates Section -->
        <section id="it-news" class="py-16 px-4 sm:px-6 lg:px-8 relative">
            <div class="absolute inset-0 bg-black/30 backdrop-blur-sm"></div>
            <div class="max-w-6xl mx-auto relative z-10">
                <div class="text-center mb-12">
                    <h2 class="text-3xl font-bold text-white mb-4 drop-shadow-lg">Latest Microsoft & Windows IT Updates</h2>
                    <p class="text-lg text-emerald-100 mb-6">Stay current with the latest IT updates</p>
                </div>
                
                <!-- IT News Feed -->
                <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                    <!-- Microsoft Official News -->
                    <div class="bg-white/95 backdrop-blur-sm rounded-lg p-6 shadow-lg">
                        <div class="flex items-center mb-4">
                            <div class="w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center mr-3">
                                <i data-feather="monitor" class="w-5 h-5 text-white"></i>
                            </div>
                            <h3 class="text-lg font-semibold text-gray-900">Microsoft Tech Community</h3>
                        </div>
                        <p class="text-sm text-gray-600 mb-4">Official Microsoft updates, announcements, and technical insights</p>
                        <a href="https://techcommunity.microsoft.com/" target="_blank" class="inline-flex items-center text-blue-600 hover:text-blue-700 font-medium">
                            <span>Visit Tech Community</span>
                            <i data-feather="external-link" class="w-4 h-4 ml-1"></i>
                        </a>
                    </div>

                    <!-- Windows Updates -->
                    <div class="bg-white/95 backdrop-blur-sm rounded-lg p-6 shadow-lg">
                        <div class="flex items-center mb-4">
                            <div class="w-10 h-10 bg-emerald-600 rounded-lg flex items-center justify-center mr-3">
                                <i data-feather="download" class="w-5 h-5 text-white"></i>
                            </div>
                            <h3 class="text-lg font-semibold text-gray-900">Windows Update History</h3>
                        </div>
                        <p class="text-sm text-gray-600 mb-4">Latest Windows updates, patches, and security releases</p>
                        <a href="https://support.microsoft.com/en-us/windows/windows-update-history" target="_blank" class="inline-flex items-center text-emerald-600 hover:text-emerald-700 font-medium">
                            <span>Check Updates</span>
                            <i data-feather="external-link" class="w-4 h-4 ml-1"></i>
                        </a>
                    </div>

                    <!-- Microsoft 365 Roadmap -->
                    <div class="bg-white/95 backdrop-blur-sm rounded-lg p-6 shadow-lg">
                        <div class="flex items-center mb-4">
                            <div class="w-10 h-10 bg-purple-600 rounded-lg flex items-center justify-center mr-3">
                                <i data-feather="calendar" class="w-5 h-5 text-white"></i>
                            </div>
                            <h3 class="text-lg font-semibold text-gray-900">M365 Roadmap</h3>
                        </div>
                        <p class="text-sm text-gray-600 mb-4">Upcoming features for Teams, SharePoint, Exchange, and more</p>
                        <a href="https://www.microsoft.com/en-us/microsoft-365/roadmap" target="_blank" class="inline-flex items-center text-purple-600 hover:text-purple-700 font-medium">
                            <span>View Roadmap</span>
                            <i data-feather="external-link" class="w-4 h-4 ml-1"></i>
                        </a>
                    </div>

                    <!-- Azure Updates -->
                    <div class="bg-white/95 backdrop-blur-sm rounded-lg p-6 shadow-lg">
                        <div class="flex items-center mb-4">
                            <div class="w-10 h-10 bg-cyan-600 rounded-lg flex items-center justify-center mr-3">
                                <i data-feather="cloud" class="w-5 h-5 text-white"></i>
                            </div>
                            <h3 class="text-lg font-semibold text-gray-900">Azure Updates</h3>
                        </div>
                        <p class="text-sm text-gray-600 mb-4">Latest Azure services, features, and cloud infrastructure updates</p>
                        <a href="https://azure.microsoft.com/en-us/updates/" target="_blank" class="inline-flex items-center text-cyan-600 hover:text-cyan-700 font-medium">
                            <span>Azure Updates</span>
                            <i data-feather="external-link" class="w-4 h-4 ml-1"></i>
                        </a>
                    </div>

                    <!-- Security Updates -->
                    <div class="bg-white/95 backdrop-blur-sm rounded-lg p-6 shadow-lg">
                        <div class="flex items-center mb-4">
                            <div class="w-10 h-10 bg-red-600 rounded-lg flex items-center justify-center mr-3">
                                <i data-feather="shield" class="w-5 h-5 text-white"></i>
                            </div>
                            <h3 class="text-lg font-semibold text-gray-900">Security Updates</h3>
                        </div>
                        <p class="text-sm text-gray-600 mb-4">Microsoft Security Response Center alerts and bulletins</p>
                        <a href="https://msrc.microsoft.com/" target="_blank" class="inline-flex items-center text-red-600 hover:text-red-700 font-medium">
                            <span>Security Center</span>
                            <i data-feather="external-link" class="w-4 h-4 ml-1"></i>
                        </a>
                    </div>

                    <!-- IT Pro Resources -->
                    <div class="bg-white/95 backdrop-blur-sm rounded-lg p-6 shadow-lg">
                        <div class="flex items-center mb-4">
                            <div class="w-10 h-10 bg-orange-600 rounded-lg flex items-center justify-center mr-3">
                                <i data-feather="users" class="w-5 h-5 text-white"></i>
                            </div>
                            <h3 class="text-lg font-semibold text-gray-900">IT Pro Community</h3>
                        </div>
                        <p class="text-sm text-gray-600 mb-4">Connect with IT professionals and access training resources</p>
                        <a href="https://learn.microsoft.com/en-us/training/" target="_blank" class="inline-flex items-center text-orange-600 hover:text-orange-700 font-medium">
                            <span>Microsoft Learn</span>
                            <i data-feather="external-link" class="w-4 h-4 ml-1"></i>
                        </a>
                    </div>
                </div>

                <!-- Quick Update Notice -->
                <div class="mt-8 text-center">
                    <div class="inline-flex items-center bg-white/20 backdrop-blur-sm rounded-lg px-4 py-2 text-white">
                        <i data-feather="refresh-cw" class="w-4 h-4 mr-2"></i>
                        <span class="text-sm">Links updated daily to provide the latest Microsoft ecosystem news</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Professional interactive section removed per user request -->

    <!-- Cloud Services Section - Sam's Microsoft Expertise -->
    <section id="services" class="py-16 px-4 sm:px-6 lg:px-8 bg-gradient-to-br from-emerald-50 to-teal-50">
        <div class="max-w-6xl mx-auto">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-gray-900 mb-4">My Microsoft Expertise</h2>
                <p class="text-lg text-gray-600 mb-8">Specialized Microsoft cloud professional with deep experience in the Microsoft ecosystem</p>
            </div>
            
            <!-- Sam's Microsoft Expertise Grid -->
            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Microsoft 365 -->
                <div class="bg-white rounded-xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 border border-gray-100">
                    <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center mb-4">
                        <i data-feather="cloud" class="w-6 h-6 text-blue-600"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-900 mb-2">Microsoft 365</h3>
                    <p class="text-gray-600 mb-3 text-sm">Expert in Office 365 deployment, Teams administration, SharePoint configuration, and Exchange Online management. Specialized in tenant migrations and security configurations.</p>
                    <div class="text-xs text-emerald-600 font-medium mb-3">✓ My expertise: Tenant setup, migrations, security policies</div>
                    <a href="https://portal.office.com" target="_blank" class="inline-flex items-center text-blue-600 hover:text-blue-700 text-sm font-medium">
                        <span>Access Portal</span>
                        <i data-feather="external-link" class="w-4 h-4 ml-1"></i>
                    </a>
                </div>

                <!-- Azure Cloud -->
                <div class="bg-white rounded-xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 border border-gray-100">
                    <div class="w-12 h-12 bg-cyan-100 rounded-lg flex items-center justify-center mb-4">
                        <i data-feather="server" class="w-6 h-6 text-cyan-600"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-900 mb-2">Azure Cloud</h3>
                    <p class="text-gray-600 mb-3 text-sm">Hands-on experience with Azure VMs, storage accounts, networking, and Active Directory integration. Skilled in hybrid cloud setups and Azure security best practices.</p>
                    <div class="text-xs text-emerald-600 font-medium mb-3">✓ My expertise: Infrastructure deployment, hybrid configurations</div>
                </div>

                <!-- Exchange Online -->
                <div class="bg-white rounded-xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 border border-gray-100">
                    <div class="w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center mb-4">
                        <i data-feather="mail" class="w-6 h-6 text-orange-600"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-900 mb-2">Exchange Online</h3>
                    <p class="text-gray-600 mb-3 text-sm">Advanced Exchange Online administration including mail flow rules, retention policies, and calendar permissions. Expert in hybrid Exchange deployments and migrations.</p>
                    <div class="text-xs text-emerald-600 font-medium mb-3">✓ My expertise: Mail flow, hybrid setups, PowerShell automation</div>
                    <a href="https://admin.exchange.microsoft.com" target="_blank" class="inline-flex items-center text-orange-600 hover:text-orange-700 text-sm font-medium">
                        <span>Exchange Admin</span>
                        <i data-feather="external-link" class="w-4 h-4 ml-1"></i>
                    </a>
                </div>

                <!-- Intune MDM -->
                <div class="bg-white rounded-xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 border border-gray-100">
                    <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center mb-4">
                        <i data-feather="smartphone" class="w-6 h-6 text-purple-600"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-900 mb-2">Intune MDM</h3>
                    <p class="text-gray-600 mb-3 text-sm">Advanced skills in device compliance policies, application deployment, and conditional access. Expert in zero-trust security implementations.</p>
                    <div class="text-xs text-emerald-600 font-medium mb-3">✓ My expertise: Zero-trust policies, device management</div>
                    <a href="https://endpoint.microsoft.com" target="_blank" class="inline-flex items-center text-purple-600 hover:text-purple-700 text-sm font-medium">
                        <span>Endpoint Portal</span>
                        <i data-feather="external-link" class="w-4 h-4 ml-1"></i>
                    </a>
                </div>

                <!-- SharePoint & Teams -->
                <div class="bg-white rounded-xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 border border-gray-100">
                    <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center mb-4">
                        <i data-feather="users" class="w-6 h-6 text-green-600"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-900 mb-2">SharePoint & Teams</h3>
                    <p class="text-gray-600 mb-3 text-sm">Expert in SharePoint site collections, permissions, and content management. Teams governance, policy management, and phone system integrations.</p>
                    <div class="text-xs text-emerald-600 font-medium mb-3">✓ My expertise: Site governance, Teams policies, collaboration</div>
                    <a href="https://admin.teams.microsoft.com" target="_blank" class="inline-flex items-center text-green-600 hover:text-green-700 text-sm font-medium">
                        <span>Teams Admin</span>
                        <i data-feather="external-link" class="w-4 h-4 ml-1"></i>
                    </a>
                </div>

                <!-- Security & Compliance -->
                <div class="bg-white rounded-xl p-6 shadow-lg hover:shadow-xl transition-all duration-300 border border-gray-100">
                    <div class="w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center mb-4">
                        <i data-feather="shield" class="w-6 h-6 text-red-600"></i>
                    </div>
                    <h3 class="text-xl font-semibold text-gray-900 mb-2">Security & Compliance</h3>
                    <p class="text-gray-600 mb-3 text-sm">Specialized in Microsoft Defender, Sentinel SIEM, compliance frameworks, and incident response. Expert in PowerShell automation for security tasks.</p>
                    <div class="text-xs text-emerald-600 font-medium mb-3">✓ My expertise: SIEM, automation, incident response</div>
                    <a href="https://security.microsoft.com" target="_blank" class="inline-flex items-center text-red-600 hover:text-red-700 text-sm font-medium">
                        <span>Security Center</span>
                        <i data-feather="external-link" class="w-4 h-4 ml-1"></i>
                    </a>
                </div>
            </div>

            <!-- Call to Action -->
            <div class="text-center mt-12">
                <button onclick="openITChatbot()" class="bg-gradient-to-r from-emerald-600 to-emerald-700 hover:from-emerald-700 hover:to-emerald-800 text-white px-8 py-4 rounded-lg font-semibold transition-all duration-300 shadow-lg hover:shadow-xl inline-flex items-center gap-2">
                    <i data-feather="message-circle" class="w-5 h-5"></i>
                    <span>Chat with Sam's AI Assistant</span>
                </button>
                <p class="text-sm text-gray-500 mt-3">Get personalized Microsoft guidance based on Sam's expertise and experience</p>
            </div>
        </div>
    </section>









    <!-- Essential IT Resources Panel -->
    <section class="py-16 px-4 sm:px-6 lg:px-8 bg-gray-50">
        <div class="max-w-6xl mx-auto">
            <div class="bg-white rounded-xl shadow-lg p-8">
                <h3 class="text-2xl font-bold text-gray-900 text-center mb-8">Essential IT Resources</h3>
                
                <!-- Standardized Links Row -->
                <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-8 gap-4">
                    <a href="https://learn.microsoft.com" target="_blank" rel="noopener" class="flex flex-col items-center p-4 rounded-lg hover:bg-blue-50 transition-colors group">
                        <div class="w-12 h-12 bg-blue-600 rounded-lg flex items-center justify-center mb-2 group-hover:scale-105 transition-transform">
                            <i data-feather="book" class="w-6 h-6 text-white"></i>
                        </div>
                        <span class="text-sm font-medium text-gray-700 text-center">Microsoft Learn</span>
                    </a>
                    
                    <a href="https://4sysops.com" target="_blank" rel="noopener" class="flex flex-col items-center p-4 rounded-lg hover:bg-green-50 transition-colors group">
                        <div class="w-12 h-12 bg-green-600 rounded-lg flex items-center justify-center mb-2 group-hover:scale-105 transition-transform">
                            <i data-feather="monitor" class="w-6 h-6 text-white"></i>
                        </div>
                        <span class="text-sm font-medium text-gray-700 text-center">4sysops</span>
                    </a>
                    
                    <a href="https://woshub.com" target="_blank" rel="noopener" class="flex flex-col items-center p-4 rounded-lg hover:bg-purple-50 transition-colors group">
                        <div class="w-12 h-12 bg-purple-600 rounded-lg flex items-center justify-center mb-2 group-hover:scale-105 transition-transform">
                            <i data-feather="settings" class="w-6 h-6 text-white"></i>
                        </div>
                        <span class="text-sm font-medium text-gray-700 text-center">Windows OS Hub</span>
                    </a>
                    
                    <a href="https://practical365.com" target="_blank" rel="noopener" class="flex flex-col items-center p-4 rounded-lg hover:bg-indigo-50 transition-colors group">
                        <div class="w-12 h-12 bg-indigo-600 rounded-lg flex items-center justify-center mb-2 group-hover:scale-105 transition-transform">
                            <i data-feather="calendar" class="w-6 h-6 text-white"></i>
                        </div>
                        <span class="text-sm font-medium text-gray-700 text-center">Practical 365</span>
                    </a>
                    
                    <a href="https://stackoverflow.com" target="_blank" rel="noopener" class="flex flex-col items-center p-4 rounded-lg hover:bg-yellow-50 transition-colors group">
                        <div class="w-12 h-12 bg-yellow-600 rounded-lg flex items-center justify-center mb-2 group-hover:scale-105 transition-transform">
                            <i data-feather="help-circle" class="w-6 h-6 text-white"></i>
                        </div>
                        <span class="text-sm font-medium text-gray-700 text-center">Stack Overflow</span>
                    </a>
                    
                    <a href="https://reddit.com/r/sysadmin" target="_blank" rel="noopener" class="flex flex-col items-center p-4 rounded-lg hover:bg-orange-50 transition-colors group">
                        <div class="w-12 h-12 bg-orange-600 rounded-lg flex items-center justify-center mb-2 group-hover:scale-105 transition-transform">
                            <i data-feather="users" class="w-6 h-6 text-white"></i>
                        </div>
                        <span class="text-sm font-medium text-gray-700 text-center">SysAdmin Reddit</span>
                    </a>
                    
                    <a href="https://docs.docker.com" target="_blank" rel="noopener" class="flex flex-col items-center p-4 rounded-lg hover:bg-blue-50 transition-colors group">
                        <div class="w-12 h-12 bg-blue-400 rounded-lg flex items-center justify-center mb-2 group-hover:scale-105 transition-transform">
                            <i data-feather="package" class="w-6 h-6 text-white"></i>
                        </div>
                        <span class="text-sm font-medium text-gray-700 text-center">Docker Docs</span>
                    </a>
                    
                    <a href="https://spiceworks.com" target="_blank" rel="noopener" class="flex flex-col items-center p-4 rounded-lg hover:bg-red-50 transition-colors group">
                        <div class="w-12 h-12 bg-red-600 rounded-lg flex items-center justify-center mb-2 group-hover:scale-105 transition-transform">
                            <i data-feather="shield" class="w-6 h-6 text-white"></i>
                        </div>
                        <span class="text-sm font-medium text-gray-700 text-center">Spiceworks</span>
                    </a>
                </div>
                
                <!-- Microsoft Cloud Services Section -->
                <div class="mt-12 grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div onclick="showCloudInfo('azure')" class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg p-6 cursor-pointer hover:shadow-lg transition-all duration-300 group">
                        <div class="flex items-center mb-3">
                            <div class="w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center mr-3">
                                <i data-feather="cloud" class="w-5 h-5 text-white"></i>
                            </div>
                            <h4 class="text-lg font-semibold text-gray-800">Microsoft Azure</h4>
                        </div>
                        <p class="text-sm text-gray-600 mb-3">Build, deploy, and scale applications with Microsoft's global cloud platform. Perfect for Windows environments with seamless Office 365 integration.</p>
                        <div class="text-xs text-blue-700 mb-2">✨ <strong>Best for:</strong> Enterprise Windows shops, hybrid scenarios</div>
                        <a href="https://portal.azure.com" target="_blank" rel="noopener" class="text-blue-600 hover:text-blue-800 text-sm font-medium">Access Portal →</a>
                    </div>
                    
                    <div onclick="showCloudInfo('m365')" class="bg-gradient-to-br from-green-50 to-green-100 rounded-lg p-6 cursor-pointer hover:shadow-lg transition-all duration-300 group">
                        <div class="flex items-center mb-3">
                            <div class="w-10 h-10 bg-green-600 rounded-lg flex items-center justify-center mr-3">
                                <i data-feather="users" class="w-5 h-5 text-white"></i>
                            </div>
                            <h4 class="text-lg font-semibold text-gray-800">Microsoft 365</h4>
                        </div>
                        <p class="text-sm text-gray-600 mb-3">Complete productivity suite with Teams, SharePoint, Exchange Online, and advanced security features for modern collaboration.</p>
                        <div class="text-xs text-green-700 mb-2">✨ <strong>Best for:</strong> Productivity, collaboration, remote work</div>
                        <a href="https://portal.office.com" target="_blank" rel="noopener" class="text-green-600 hover:text-green-800 text-sm font-medium">Access Portal →</a>
                    </div>
                </div>
                
                <!-- Quick Access Note -->
                <div class="mt-6 text-center">
                    <p class="text-gray-500 text-sm">Quick access to essential IT documentation and cloud platforms</p>
                </div>
            </div>
        </div>
    </section>

    <!-- About section removed from middle; About panel accessible via top nav (keeps journey text) -->
    <script>
        // update about panel text with journey
        document.addEventListener('DOMContentLoaded', ()=>{
            const panel = document.getElementById('about-panel')
            if (panel) {
                const p = panel.querySelector('.mt-4');
                if (p) {
                    p.innerHTML = '<p class="text-gray-700">I began my IT journey building desktops and supporting users, then moved into servers, virtualization and cloud. Over the last few years I focused on Microsoft 365 and Azure operations — automating tasks with PowerShell, designing governance, and running resilient backups. I enjoy practical labs, teaching, and keeping systems secure and well-instrumented.</p>'
                }
            }
        })
    </script>

    <!-- Contact Section -->
    <section id="contact" class="py-24 px-4 sm:px-6 lg:px-8 bg-gradient-to-br from-gray-50 to-white">
        <div class="max-w-6xl mx-auto">
            <div class="text-center mb-16">
                <h2 class="text-4xl md:text-5xl font-bold text-gray-800 mb-6">Let's Connect</h2>
                <p class="text-xl text-gray-600 max-w-3xl mx-auto leading-relaxed">
                    Ready to discuss cloud solutions, automation strategies, or collaboration opportunities? I'd love to hear from you.
                </p>
                <div class="w-24 h-1 bg-gradient-to-r from-emerald-500 to-blue-500 mx-auto mt-6 rounded-full"></div>
            </div>
            
            <div class="grid lg:grid-cols-2 gap-12 items-start">
                <!-- Contact Information -->
                <div>
                    <h3 class="text-2xl font-bold text-gray-800 mb-8">Get In Touch</h3>
                    <div class="space-y-6">
                        <div class="flex items-start gap-4 p-6 bg-white rounded-xl shadow-sm border border-gray-100 hover:shadow-md transition-shadow">
                            <div class="flex-shrink-0 p-3 rounded-lg bg-emerald-100">
                                <i data-feather="mail" class="text-emerald-600 w-6 h-6"></i>
                            </div>
                            <div>
                                <h4 class="font-semibold text-gray-800 text-lg mb-1">Email</h4>
                                <a href="mailto:shamsherintech@gmail.com" class="text-emerald-600 hover:text-emerald-700 transition-colors font-medium">shamsherintech@gmail.com</a>
                                <p class="text-gray-500 text-sm mt-1">Best for detailed technical discussions</p>
                            </div>
                        </div>
                        
                        <div class="flex items-start gap-4 p-6 bg-white rounded-xl shadow-sm border border-gray-100 hover:shadow-md transition-shadow">
                            <div class="flex-shrink-0 p-3 rounded-lg bg-blue-100">
                                <i data-feather="linkedin" class="text-blue-600 w-6 h-6"></i>
                            </div>
                            <div>
                                <h4 class="font-semibold text-gray-800 text-lg mb-1">LinkedIn</h4>
                                <a href="https://www.linkedin.com/in/sam-a-7238b3306?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medium=ios_app" target="_blank" rel="noopener" class="text-blue-600 hover:text-blue-700 transition-colors font-medium">Connect with me</a>
                                <p class="text-gray-500 text-sm mt-1">Professional networking & updates</p>
                            </div>
                        </div>
                        
                        <div class="p-6 bg-gradient-to-br from-emerald-50 to-blue-50 rounded-xl border border-emerald-200/50">
                            <h4 class="font-semibold text-gray-800 mb-2">Response Time</h4>
                            <p class="text-gray-600 text-sm">I typically respond within 24-48 hours. For urgent matters, please mention "URGENT" in your subject line.</p>
                        </div>
                    </div>
                </div>

                <!-- Contact Form -->
                <div class="bg-white rounded-2xl shadow-lg p-8 border border-gray-100">
                    <h3 class="text-2xl font-bold text-gray-800 mb-6">Send a Message</h3>
                    <form class="space-y-6" action="https://formsubmit.co/shamsherintech@gmail.com" method="POST">
                        <!-- Form submits to FormSubmit which will forward the message to shamsherintech@gmail.com -->
                        <input type="hidden" name="_subject" value="New contact from Sam in Cloud portfolio website">
                        <input type="hidden" name="_captcha" value="false">
                        <input type="hidden" name="_next" value="https://samincloud.com/thank-you.html">
                        <input type="hidden" name="_template" value="table">
                        <input type="hidden" name="_cc" value="shamsherintech@gmail.com">
                        
                        <div class="grid sm:grid-cols-2 gap-4">
                            <div>
                                <label for="name" class="block text-gray-700 font-semibold mb-2">Name *</label>
                                <input type="text" id="name" name="name" required class="w-full px-4 py-3 rounded-lg border-2 border-gray-200 bg-gray-50 text-gray-800 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors">
                            </div>
                            <div>
                                <label for="email" class="block text-gray-700 font-semibold mb-2">Email *</label>
                                <input type="email" id="email" name="email" required class="w-full px-4 py-3 rounded-lg border-2 border-gray-200 bg-gray-50 text-gray-800 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors">
                            </div>
                        </div>
                        
                        <div>
                            <label for="subject" class="block text-gray-700 font-semibold mb-2">Subject</label>
                            <input type="text" id="subject" name="subject" placeholder="e.g., Azure consultation, collaboration opportunity" class="w-full px-4 py-3 rounded-lg border-2 border-gray-200 bg-gray-50 text-gray-800 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors">
                        </div>
                        
                        <div>
                            <label for="message" class="block text-gray-700 font-semibold mb-2">Message *</label>
                            <textarea id="message" name="message" rows="5" required placeholder="Tell me about your project, questions, or how I can help..." class="w-full px-4 py-3 rounded-lg border-2 border-gray-200 bg-gray-50 text-gray-800 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-emerald-500 transition-colors resize-none"></textarea>
                        </div>
                        
                        <button type="submit" class="w-full bg-gradient-to-r from-emerald-600 to-emerald-700 hover:from-emerald-700 hover:to-emerald-800 text-white px-8 py-4 rounded-lg font-semibold transition-all duration-300 shadow-lg hover:shadow-xl transform hover:-translate-y-1 flex items-center justify-center gap-2" onclick="trackFormSubmission()">
                            <i data-feather="send" class="w-5 h-5"></i>
                            Send Message
                        </button>
                    </form>
                    
                    <div class="mt-6 p-4 bg-blue-50 rounded-lg border border-blue-200">
                        <div class="flex items-start gap-3">
                            <i data-feather="info" class="w-5 h-5 text-blue-600 mt-0.5"></i>
                            <div>
                                <h5 class="font-semibold text-blue-800 mb-1">First Time Users</h5>
                                <p class="text-blue-700 text-sm">If this is the first form submission, you'll need to verify the email address. Check your spam folder for a verification email from FormSubmit.</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mt-6 p-4 bg-gray-50 rounded-lg border">
                        <p class="text-sm text-gray-600 leading-relaxed">
                            <i data-feather="shield" class="w-4 h-4 inline mr-1 text-gray-500"></i>
                            <strong>Privacy:</strong> Your information is only used to respond to your inquiry. Messages are securely forwarded via FormSubmit.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- IT Help Chatbot Popup -->
    <div id="it-chatbot-overlay" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="flex items-center justify-center min-h-screen p-4">
            <div class="bg-white rounded-lg shadow-2xl w-full max-w-md h-96 flex flex-col">
                <!-- Chatbot Header -->
                <div class="bg-gradient-to-r from-emerald-600 to-emerald-700 text-white p-4 rounded-t-lg flex items-center justify-between">
                    <div class="flex items-center gap-3">
                        <div class="w-8 h-8 bg-white/20 rounded-full flex items-center justify-center">
                            <i data-feather="cpu" class="w-4 h-4"></i>
                        </div>
                        <div>
                            <h3 class="font-semibold">Sam's AI Assistant</h3>
                            <p class="text-xs text-emerald-100">Expert knowledge of Sam's experience</p>
                        </div>
                    </div>
                    <button onclick="closeITChatbot()" class="text-white hover:text-emerald-200 transition-colors">
                        <i data-feather="x" class="w-5 h-5"></i>
                    </button>
                </div>
                
                <!-- Chat Messages Area -->
                <div id="chat-messages" class="flex-1 p-4 overflow-y-auto bg-gray-50">
                    <div class="space-y-3">
                        <div class="flex items-start gap-2">
                            <div class="w-6 h-6 bg-emerald-600 rounded-full flex items-center justify-center flex-shrink-0">
                                <i data-feather="cpu" class="w-3 h-3 text-white"></i>
                            </div>
                            <div class="bg-white p-3 rounded-lg shadow-sm max-w-xs">
                                <p class="text-sm text-gray-800">🚀 <strong>I'm Sam's AI Assistant - Expert knowledge of his Microsoft experience!</strong></p>
                                <p class="text-xs text-gray-600 mt-2">Ask me about Sam's experience with:</p>
                                <ul class="text-xs text-gray-600 mt-1 space-y-1">
                                    <li>⭐ <strong>Microsoft 365</strong> (Teams, SharePoint, Exchange migrations)</li>
                                    <li>☁️ <strong>Azure Cloud</strong> (VMs, hybrid setups, Active Directory)</li>
                                    <li>🔧 <strong>Exchange Online</strong> (Mail flow, calendar permissions, PowerShell)</li>
                                    <li>🛡️ <strong>Intune & Security</strong> (Zero-trust, compliance, Defender)</li>
                                    <li>⚡ <strong>PowerShell Automation</strong> (Scripts, security tasks)</li>
                                    <li>👥 <strong>Teams & SharePoint</strong> (Governance, permissions, policies)</li>
                                </ul>
                                <p class="text-xs text-emerald-600 mt-2 font-medium">✨ I can help with licensing, pricing, troubleshooting, and any Microsoft ecosystem question!</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Quick Action Buttons -->
                <div class="p-3 border-t bg-white">
                    <div class="grid grid-cols-2 gap-2 mb-3">
                        <button onclick="askPredefinedQuestion('I forgot my password, how do I reset it?')" class="text-xs bg-green-50 hover:bg-green-100 text-green-700 px-2 py-1 rounded transition-colors">
                            Password Reset
                        </button>
                        <button onclick="askPredefinedQuestion('Computer is running very slow, what should I check?')" class="text-xs bg-blue-50 hover:bg-blue-100 text-blue-700 px-2 py-1 rounded transition-colors">
                            Slow Computer
                        </button>
                        <button onclick="askPredefinedQuestion('Exchange mail flow problems, emails not delivering')" class="text-xs bg-orange-50 hover:bg-orange-100 text-orange-700 px-2 py-1 rounded transition-colors">
                            Email Issues
                        </button>
                        <button onclick="askPredefinedQuestion('How much does Microsoft 365 cost in Australia?')" class="text-xs bg-purple-50 hover:bg-purple-100 text-purple-700 px-2 py-1 rounded transition-colors">
                            M365 Pricing
                        </button>
                    </div>
                    
                    <!-- Chat Input -->
                    <div class="flex gap-2">
                        <input 
                            type="text" 
                            id="chat-input" 
                            placeholder="Describe your IT issue in detail..."
                            class="flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-emerald-500 text-sm"
                            onkeypress="handleChatKeyPress(event)"
                        >
                        <button onclick="sendChatMessage()" class="bg-emerald-600 hover:bg-emerald-700 text-white px-3 py-2 rounded-lg transition-colors">
                            <i data-feather="send" class="w-4 h-4"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gradient-to-br from-gray-900 to-gray-800 text-white py-16 px-4 sm:px-6 lg:px-8">
        <div class="max-w-6xl mx-auto">
            <div class="grid md:grid-cols-3 gap-8 mb-12">
                <!-- Brand & Description -->
                <div class="md:col-span-2">
                    <h3 class="text-2xl font-bold mb-4">Sam Adhikari</h3>
                    <p class="text-gray-300 mb-6 max-w-md leading-relaxed">
                        Cloud Solutions Specialist helping organizations optimize their Microsoft 365 and Azure environments through automation and best practices.
                    </p>
                    <div class="flex space-x-4">
                        <a href="https://www.linkedin.com/in/sam-a-7238b3306?utm_source=share&utm_campaign=share_via&utm_content=profile&utm_medium=ios_app" target="_blank" rel="noopener" class="p-3 bg-white/10 hover:bg-white/20 rounded-lg transition-all duration-300 hover:-translate-y-1">
                            <i data-feather="linkedin" class="w-5 h-5"></i>
                        </a>
                        <a href="mailto:shamsherintech@gmail.com" class="p-3 bg-white/10 hover:bg-white/20 rounded-lg transition-all duration-300 hover:-translate-y-1">
                            <i data-feather="mail" class="w-5 h-5"></i>
                        </a>
                        <a href="https://github.com/shamadi379" target="_blank" rel="noopener" class="p-3 bg-white/10 hover:bg-white/20 rounded-lg transition-all duration-300 hover:-translate-y-1">
                            <i data-feather="github" class="w-5 h-5"></i>
                        </a>
                    </div>
                </div>
                
                <!-- Quick Links -->
                <div>
                    <h4 class="text-lg font-semibold mb-4">Quick Links</h4>
                    <div class="space-y-3">
                        <a href="#home" class="block text-gray-300 hover:text-white transition-colors">Home</a>
                        <a href="#about" class="block text-gray-300 hover:text-white transition-colors">About</a>
                        <a href="#services" class="block text-gray-300 hover:text-white transition-colors">Services</a>
                        <a href="#it-news" class="block text-gray-300 hover:text-white transition-colors">IT News</a>
                        <a href="#contact" class="block text-gray-300 hover:text-white transition-colors">Contact</a>
                    </div>
                </div>
            </div>
            
            <div class="border-t border-gray-700 pt-8">
                <div class="flex flex-col md:flex-row justify-between items-center">
                    <p class="text-gray-400 mb-4 md:mb-0">© 2025 Sam Adhikari. All rights reserved.</p>
                    <p class="text-gray-500 text-sm">Built with passion for cloud technology</p>
                </div>
                <div class="text-center mt-4 pt-4 border-t border-gray-800">
                    <p class="text-gray-500 text-xs">Website design and AI assistant © Sam Adhikari | External libraries used under their respective licenses</p>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // Conversation History for AI Context
        let conversationHistory = [];
        const MAX_HISTORY = 10; // Keep last 10 exchanges for context
        
        // Enhanced AI with conversation memory
        function addToConversationHistory(message, sender) {
            conversationHistory.push({
                role: sender === 'user' ? 'user' : 'assistant',
                content: message,
                timestamp: new Date()
            });
            
            // Keep only the last MAX_HISTORY messages
            if (conversationHistory.length > MAX_HISTORY * 2) { // *2 because we store both user and assistant
                conversationHistory = conversationHistory.slice(-MAX_HISTORY * 2);
            }
        }
        
        // Get conversation context for AI
        function getConversationContext() {
            if (conversationHistory.length === 0) return '';
            
            return conversationHistory
                .slice(-6) // Last 3 exchanges (6 messages)
                .map(msg => `${msg.role}: ${msg.content}`)
                .join('\n');
        }

        // Vanta background removed (user requested no blue background)

        // Mobile menu toggle
        const menuBtn = document.getElementById('menu-btn');
        const closeMenu = document.getElementById('close-menu');
        const mobileMenu = document.getElementById('mobile-menu');

        menuBtn.addEventListener('click', () => {
            mobileMenu.classList.remove('hidden');
            feather.replace();
        });

        closeMenu.addEventListener('click', () => {
            mobileMenu.classList.add('hidden');
        });

        // Close menu when clicking on a link
        document.querySelectorAll('#mobile-menu a').forEach(link => {
            link.addEventListener('click', () => {
                mobileMenu.classList.add('hidden');
            });
        });

        // Smooth scrolling and About-panel logic
        const aboutPanel = document.getElementById('about-panel');
        const closeAboutBtn = document.getElementById('close-about-panel');

        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = this.getAttribute('href');

                // If About link clicked, show the top about panel and scroll to it
                if (target === '#about') {
                    if (aboutPanel.classList.contains('hidden')) {
                        aboutPanel.classList.remove('hidden');
                    }
                    aboutPanel.scrollIntoView({ behavior: 'smooth' });
                } else {
                    const el = document.querySelector(target);
                    if (el) el.scrollIntoView({ behavior: 'smooth' });
                }

                // Close mobile menu if open
                if (!mobileMenu.classList.contains('hidden')) {
                    mobileMenu.classList.add('hidden');
                }
            });
        });

        if (closeAboutBtn) {
            closeAboutBtn.addEventListener('click', () => {
                aboutPanel.classList.add('hidden');
            });
        }

        // Initialize feather icons
        feather.replace();
        // Track form submission for debugging
        function trackFormSubmission() {
            console.log('Contact form submitted at:', new Date().toISOString());
            // You can check browser console for this message
        }

        // Load content when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Content loaded - no blog posts to load anymore
        });

        async function loadMicrosoftHub() {
            const hubContent = document.getElementById('hub-content');
            const hubLoading = document.getElementById('hub-loading');
            
            try {
                // Comprehensive IT search directory with natural language support
                const searchDirectory = [
                    // Microsoft Azure - How to guides
                    {
                        title: "How to Fix Azure Backup Failures",
                        description: "Complete guide to troubleshoot Azure backup errors, recovery vault issues, and backup agent problems.",
                        link: "https://learn.microsoft.com/en-us/azure/backup/backup-azure-troubleshoot-vm-backup-fails-snapshot-timeout",
                        pubDate: new Date().toISOString(),
                        sourceName: "Microsoft Learn",
                        sourceColor: "bg-blue-600",
                        category: "azure microsoft troubleshooting backup",
                        keywords: "how to fix azure backup failed error recovery vault agent snapshot timeout troubleshoot"
                    },
                    {
                        title: "How to Set Up Azure Virtual Machines",
                        description: "Step-by-step guide to create, configure, and manage Azure VMs with best practices and troubleshooting.",
                        link: "https://learn.microsoft.com/en-us/azure/virtual-machines/",
                        pubDate: new Date().toISOString(),
                        sourceName: "Microsoft Learn",
                        sourceColor: "bg-blue-600",
                        category: "azure microsoft setup configuration",
                        keywords: "how to create azure vm virtual machine setup configure deploy troubleshoot"
                    },
                    {
                        title: "How to Configure Azure Active Directory",
                        description: "Complete AAD setup guide including user management, security policies, and sync troubleshooting.",
                        link: "https://learn.microsoft.com/en-us/azure/active-directory/",
                        pubDate: new Date().toISOString(),
                        sourceName: "Microsoft Learn",
                        sourceColor: "bg-blue-600",
                        category: "azure microsoft activedirectory security",
                        keywords: "how to setup azure active directory aad users sync configure troubleshoot authentication"
                    },
                    // Exchange & Email - How to guides
                    {
                        title: "How to Migrate to Exchange Online",
                        description: "Complete Exchange migration guide with hybrid setup, mailbox moves, and troubleshooting steps.",
                        link: "https://learn.microsoft.com/en-us/exchange/mailbox-migration/mailbox-migration",
                        pubDate: new Date().toISOString(),
                        sourceName: "Microsoft Learn",
                        sourceColor: "bg-blue-600",
                        category: "exchange microsoft migration email",
                        keywords: "how to migrate exchange online mailbox hybrid setup troubleshoot email migration"
                    },
                    {
                        title: "How to Fix Email Delivery Issues",
                        description: "Troubleshoot email delivery problems, message trace, and mail flow issues in Exchange Online.",
                        link: "https://learn.microsoft.com/en-us/exchange/mail-flow-best-practices/troubleshoot-mail-flow",
                        pubDate: new Date().toISOString(),
                        sourceName: "Microsoft Learn",
                        sourceColor: "bg-blue-600",
                        category: "exchange microsoft troubleshooting email",
                        keywords: "how to fix email delivery issues message trace mail flow troubleshoot exchange online"
                    },
                    // PowerShell - How to guides
                    {
                        title: "How to Fix PowerShell Execution Policy Errors",
                        description: "Resolve PowerShell execution policy issues, script signing, and security policy configurations.",
                        link: "https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_execution_policies",
                        pubDate: new Date().toISOString(),
                        sourceName: "Microsoft Learn",
                        sourceColor: "bg-blue-600",
                        category: "powershell microsoft troubleshooting scripting",
                        keywords: "how to fix powershell execution policy error script signing security troubleshoot"
                    },
                    {
                        title: "How to Automate Tasks with PowerShell",
                        description: "Learn PowerShell automation techniques, scripting best practices, and task scheduling.",
                        link: "https://learn.microsoft.com/en-us/powershell/scripting/",
                        pubDate: new Date().toISOString(),
                        sourceName: "Microsoft Learn",
                        sourceColor: "bg-blue-600",
                        category: "powershell microsoft automation scripting",
                        keywords: "how to automate tasks powershell script automation scheduled tasks"
                    },
                    // Windows Server - How to guides
                    {
                        title: "How to Fix DNS Resolution Problems",
                        description: "Troubleshoot DNS issues, configure forwarders, and resolve name resolution problems in Windows Server.",
                        link: "https://learn.microsoft.com/en-us/windows-server/networking/dns/troubleshoot/troubleshoot-dns-client",
                        pubDate: new Date().toISOString(),
                        sourceName: "Microsoft Learn",
                        sourceColor: "bg-blue-600",
                        category: "server microsoft troubleshooting dns networking",
                        keywords: "how to fix dns resolution problems troubleshoot name resolution windows server"
                    },
                    {
                        title: "How to Set Up Windows Server Roles",
                        description: "Install and configure Windows Server roles including AD DS, DHCP, DNS, and file services.",
                        link: "https://learn.microsoft.com/en-us/windows-server/get-started/server-roles",
                        pubDate: new Date().toISOString(),
                        sourceName: "Microsoft Learn",
                        sourceColor: "bg-blue-600",
                        category: "server microsoft setup configuration",
                        keywords: "how to setup windows server roles install configure ad ds dhcp dns file services"
                    },
                    // Networking - How to guides
                    {
                        title: "How to Troubleshoot Network Connectivity",
                        description: "Network diagnostic commands, tools, and techniques for resolving connectivity issues.",
                        link: "https://www.cisco.com/c/en/us/support/docs/ip/routing-information-protocol-rip/13769-5.html",
                        pubDate: new Date().toISOString(),
                        sourceName: "Cisco Support",
                        sourceColor: "bg-blue-800",
                        category: "networking troubleshooting connectivity infrastructure",
                        keywords: "how to troubleshoot network connectivity ping traceroute telnet netstat nslookup"
                    },
                    {
                        title: "How to Configure Cisco Switches and Routers",
                        description: "Basic and advanced Cisco device configuration, VLAN setup, and routing protocols.",
                        link: "https://www.cisco.com/c/en/us/support/switches/catalyst-2960-series-switches/products-configuration-guides-list.html",
                        pubDate: new Date().toISOString(),
                        sourceName: "Cisco Support",
                        sourceColor: "bg-blue-800",
                        category: "networking cisco configuration setup",
                        keywords: "how to configure cisco switch router vlan setup routing protocols"
                    },
                    // Linux - How to guides
                    {
                        title: "How to Monitor Linux Server Performance",
                        description: "Linux performance monitoring tools, commands, and techniques for system optimization.",
                        link: "https://www.redhat.com/en/topics/linux/linux-performance-monitoring-tools",
                        pubDate: new Date().toISOString(),
                        sourceName: "Red Hat",
                        sourceColor: "bg-red-600",
                        category: "linux monitoring performance administration",
                        keywords: "how to monitor linux server performance top htop iotop vmstat troubleshoot"
                    },
                    {
                        title: "How to Set Up Linux File Permissions",
                        description: "Understanding and configuring Linux file permissions, ownership, and access control.",
                        link: "https://www.redhat.com/en/topics/linux/what-are-linux-file-permissions",
                        pubDate: new Date().toISOString(),
                        sourceName: "Red Hat",
                        sourceColor: "bg-red-600",
                        category: "linux security permissions administration",
                        keywords: "how to setup linux file permissions chmod chown access control security"
                    },
                    // Security - How to guides
                    {
                        title: "How to Implement Network Security",
                        description: "Network security best practices, firewall configuration, and intrusion detection systems.",
                        link: "https://www.sans.org/white-papers/1920/",
                        pubDate: new Date().toISOString(),
                        sourceName: "SANS Institute",
                        sourceColor: "bg-red-500",
                        category: "security networking firewall protection",
                        keywords: "how to implement network security firewall ids ips intrusion detection protection"
                    },
                    {
                        title: "How to Respond to Security Incidents",
                        description: "Incident response procedures, forensics, and security breach management strategies.",
                        link: "https://www.sans.org/white-papers/504/",
                        pubDate: new Date().toISOString(),
                        sourceName: "SANS Institute",
                        sourceColor: "bg-red-500",
                        category: "security incident response forensics",
                        keywords: "how to respond security incident breach forensics investigation response plan"
                    },
                    // Database - How to guides
                    {
                        title: "How to Optimize SQL Server Performance",
                        description: "SQL Server performance tuning, query optimization, and database maintenance techniques.",
                        link: "https://learn.microsoft.com/en-us/sql/relational-databases/performance/performance-monitoring-and-tuning-tools",
                        pubDate: new Date().toISOString(),
                        sourceName: "Microsoft SQL Docs",
                        sourceColor: "bg-red-600",
                        category: "database sql performance optimization",
                        keywords: "how to optimize sql server performance tuning query database maintenance troubleshoot"
                    },
                    {
                        title: "How to Backup and Restore Databases",
                        description: "Database backup strategies, restoration procedures, and disaster recovery planning.",
                        link: "https://learn.microsoft.com/en-us/sql/relational-databases/backup-restore/",
                        pubDate: new Date().toISOString(),
                        sourceName: "Microsoft SQL Docs",
                        sourceColor: "bg-red-600",
                        category: "database sql backup recovery",
                        keywords: "how to backup restore database sql server disaster recovery maintenance"
                    },
                    // Virtualization - How to guides
                    {
                        title: "How to Set Up VMware vSphere",
                        description: "VMware vSphere installation, configuration, and virtual machine management guide.",
                        link: "https://docs.vmware.com/en/VMware-vSphere/",
                        pubDate: new Date().toISOString(),
                        sourceName: "VMware Docs",
                        sourceColor: "bg-green-600",
                        category: "virtualization vmware setup configuration",
                        keywords: "how to setup vmware vsphere virtual machine vm configuration installation"
                    },
                    {
                        title: "How to Troubleshoot Hyper-V Issues",
                        description: "Windows Hyper-V troubleshooting, VM performance issues, and configuration problems.",
                        link: "https://learn.microsoft.com/en-us/windows-server/virtualization/hyper-v/",
                        pubDate: new Date().toISOString(),
                        sourceName: "Microsoft Learn",
                        sourceColor: "bg-blue-600",
                        category: "virtualization hyperv troubleshooting microsoft",
                        keywords: "how to troubleshoot hyper-v issues vm virtual machine performance problems"
                    },
                    // DevOps & Containers - How to guides
                    {
                        title: "How to Use Docker for Applications",
                        description: "Docker container basics, image creation, deployment, and troubleshooting guide.",
                        link: "https://docs.docker.com/get-started/",
                        pubDate: new Date().toISOString(),
                        sourceName: "Docker Docs",
                        sourceColor: "bg-blue-400",
                        category: "containers docker devops deployment",
                        keywords: "how to use docker containers image deployment application troubleshoot"
                    },
                    {
                        title: "How to Manage Kubernetes Clusters",
                        description: "Kubernetes cluster management, pod troubleshooting, and application deployment strategies.",
                        link: "https://kubernetes.io/docs/tutorials/",
                        pubDate: new Date().toISOString(),
                        sourceName: "Kubernetes Docs",
                        sourceColor: "bg-blue-700",
                        category: "kubernetes containers orchestration devops",
                        keywords: "how to manage kubernetes cluster pods deployment troubleshoot orchestration"
                    },
                    // General IT Support - How to guides
                    {
                        title: "How to Troubleshoot Computer Problems",
                        description: "General computer troubleshooting techniques, hardware diagnostics, and software issues.",
                        link: "https://support.microsoft.com/en-us/windows/troubleshoot-pc-problems-c427c4b0-f51d-4bd3-b6c6-3e15e6b70c1c",
                        pubDate: new Date().toISOString(),
                        sourceName: "Microsoft Support",
                        sourceColor: "bg-blue-600",
                        category: "troubleshooting computer support general",
                        keywords: "how to troubleshoot computer problems hardware software issues diagnostics repair"
                    },
                    {
                        title: "How to Set Up Remote Access",
                        description: "Configure VPN, RDP, SSH, and other remote access solutions for secure connectivity.",
                        link: "https://learn.microsoft.com/en-us/windows-server/remote/remote-desktop-services/",
                        pubDate: new Date().toISOString(),
                        sourceName: "Microsoft Learn",
                        sourceColor: "bg-blue-600",
                        category: "remote access vpn rdp ssh connectivity",
                        keywords: "how to setup remote access vpn rdp ssh remote desktop connectivity"
                    },
                    // Community Resources
                    {
                        title: "IT Community Support and Forums",
                        description: "Get help from IT professionals worldwide on Reddit, Stack Overflow, and specialized forums.",
                        link: "https://reddit.com/r/sysadmin/",
                        pubDate: new Date().toISOString(),
                        sourceName: "Reddit SysAdmin",
                        sourceColor: "bg-orange-600",
                        category: "community support forums help",
                        keywords: "it community support forums help sysadmin questions answers troubleshooting"
                    }
                ];

                allHubContent = searchDirectory;
                
                // Don't display any content by default - only show search interface
                hubLoading.classList.add('hidden');
                hubContent.classList.remove('hidden');
                hubContent.innerHTML = `
                    <div class="col-span-full text-center py-16">
                        <div class="max-w-2xl mx-auto">
                            <i data-feather="search" class="w-16 h-16 text-gray-400 mx-auto mb-4"></i>
                            <h3 class="text-2xl font-bold text-gray-700 mb-4">Ask Your IT Questions</h3>
                            <p class="text-gray-600 mb-6">
                                Ask me anything about IT troubleshooting, setup guides, or system administration. 
                                I understand natural language and will find the exact resources you need.
                            </p>
                            <div class="bg-blue-50 rounded-lg p-4 mb-6 text-left">
                                <h4 class="font-semibold text-blue-800 mb-2">Try asking questions like:</h4>
                                <ul class="text-sm text-blue-700 space-y-1">
                                    <li>• "How to fix Azure backup failures?"</li>
                                    <li>• "Troubleshoot Exchange email delivery issues"</li>
                                    <li>• "PowerShell execution policy error"</li>
                                    <li>• "Setup Windows Server DNS"</li>
                                    <li>• "Linux server performance monitoring"</li>
                                    <li>• "Docker container networking problems"</li>
                                </ul>
                            </div>
                            <p class="text-sm text-gray-500">
                                Just type your question or describe your problem above - I'll understand and direct you to the right solution!
                            </p>
                        </div>
                    </div>
                `;

                // Initialize feather icons
                if (typeof feather !== 'undefined') {
                    feather.replace();
                }

            } catch (error) {
                console.error('Error loading IT Hub:', error);
                hubLoading.innerHTML = `
                    <div class="text-center py-12">
                        <p class="text-gray-600">Search functionality temporarily unavailable.</p>
                    </div>
                `;
            }
        }

        function displayHubContent(articles) {
            const hubContent = document.getElementById('hub-content');
            
            if (articles.length === 0) {
                hubContent.innerHTML = `
                    <div class="col-span-full text-center py-12">
                        <i data-feather="search" class="w-12 h-12 text-gray-400 mx-auto mb-4"></i>
                        <h3 class="text-xl font-bold text-gray-700 mb-2">No Results Found</h3>
                        <p class="text-gray-600 mb-4">Try searching with different keywords or browse by category.</p>
                        <button onclick="clearSearch()" class="text-blue-600 hover:text-blue-800 font-medium">Clear Search</button>
                    </div>
                `;
                if (typeof feather !== 'undefined') {
                    feather.replace();
                }
                return;
            }
            
            hubContent.innerHTML = articles.map(article => {
                const categoryBadge = getCategoryBadge(article.category);
                const categoryClass = getCategoryClass(article.category);
                
                return `
                    <div class="hub-card ${categoryClass}" data-category="${article.category}">
                        <div class="hub-card-category-badge">${categoryBadge}</div>
                        <div class="hub-card-source ${article.sourceColor}">
                            ${article.sourceName}
                        </div>
                        <h3 class="hub-card-title">
                            <a href="${article.link}" target="_blank" rel="noopener" class="hover:text-blue-600 transition-colors">
                                ${article.title}
                            </a>
                        </h3>
                        <p class="hub-card-excerpt">${article.description}</p>
                        <div class="hub-card-meta">
                            <span>Official Resource</span>
                            <a href="${article.link}" target="_blank" rel="noopener" class="text-blue-600 hover:text-blue-800 font-medium transition-colors">
                                Visit Resource →
                            </a>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function getCategoryBadge(category) {
            const badges = {
                'azure': 'AZURE',
                'exchange': 'EXCHANGE',
                'intune': 'INTUNE',
                'powershell': 'PS',
                'server': 'SERVER',
                'troubleshooting': 'FIX',
                'security': 'SEC'
            };
            
            for (const [key, badge] of Object.entries(badges)) {
                if (category.includes(key)) return badge;
            }
            return 'GUIDE';
        }

        function getCategoryClass(category) {
            return category.replace(/\s+/g, '-').toLowerCase();
        }

        // Enhanced search functionality with natural language support
        function searchHub(query = null) {
            const searchInput = document.getElementById('hub-search');
            const searchTerm = (query || searchInput.value).toLowerCase().trim();
            
            if (!searchTerm) {
                // Show default search interface when no search term
                loadMicrosoftHub();
                return;
            }

            // Enhanced search with natural language understanding
            const filteredContent = allHubContent.filter(article => {
                const searchWords = searchTerm.split(' ').filter(word => word.length > 2);
                const itemText = `${article.title} ${article.description} ${article.keywords}`.toLowerCase();
                
                // Question pattern matching for natural language queries
                const questionPatterns = [
                    { pattern: /how to (.*)/i, weight: 3 },
                    { pattern: /how do i (.*)/i, weight: 3 },
                    { pattern: /how can i (.*)/i, weight: 3 },
                    { pattern: /what is (.*)/i, weight: 2 },
                    { pattern: /why is (.*)/i, weight: 2 },
                    { pattern: /troubleshoot (.*)/i, weight: 3 },
                    { pattern: /fix (.*)/i, weight: 3 },
                    { pattern: /setup (.*)/i, weight: 2 },
                    { pattern: /configure (.*)/i, weight: 2 },
                    { pattern: /install (.*)/i, weight: 2 },
                    { pattern: /migrate (.*)/i, weight: 2 },
                    { pattern: /backup (.*)/i, weight: 2 },
                    { pattern: /restore (.*)/i, weight: 2 },
                    { pattern: /monitor (.*)/i, weight: 2 },
                    { pattern: /optimize (.*)/i, weight: 2 }
                ];

                let score = 0;
                
                // Check for question patterns and extract key terms
                questionPatterns.forEach(pattern => {
                    if (pattern.pattern.test(searchTerm)) {
                        const extracted = searchTerm.match(pattern.pattern)[1];
                        if (itemText.includes(extracted)) {
                            score += pattern.weight;
                        }
                    }
                });

                // Word matching with relevance scoring
                searchWords.forEach(word => {
                    if (itemText.includes(word)) {
                        // Higher score for title matches
                        if (article.title.toLowerCase().includes(word)) score += 3;
                        // Medium score for keyword matches
                        else if (article.keywords.toLowerCase().includes(word)) score += 2;
                        // Lower score for description matches
                        else if (article.description.toLowerCase().includes(word)) score += 1;
                    }
                });

                // Technology-specific boosting for better IT context understanding
                const techKeywords = {
                    'azure': ['azure', 'microsoft', 'cloud', 'vm', 'virtual', 'machine'],
                    'exchange': ['exchange', 'email', 'mailbox', 'mail', 'message', 'delivery'],
                    'powershell': ['powershell', 'script', 'automation', 'cmdlet', 'execution', 'policy'],
                    'windows': ['windows', 'server', 'microsoft', 'domain', 'controller'],
                    'network': ['network', 'dns', 'ping', 'connectivity', 'router', 'switch', 'cisco'],
                    'linux': ['linux', 'ubuntu', 'centos', 'redhat', 'unix', 'command'],
                    'docker': ['docker', 'container', 'kubernetes', 'orchestration', 'deployment'],
                    'security': ['security', 'firewall', 'breach', 'incident', 'vulnerability'],
                    'database': ['sql', 'database', 'mysql', 'postgres', 'backup', 'restore'],
                    'active': ['active', 'directory', 'ad', 'authentication', 'ldap'],
                    'virtualization': ['vmware', 'hyper-v', 'virtual', 'vm', 'vsphere'],
                    'backup': ['backup', 'restore', 'recovery', 'disaster', 'vault'],
                    'performance': ['performance', 'optimization', 'monitoring', 'tuning', 'slow'],
                    'error': ['error', 'problem', 'issue', 'troubleshoot', 'fix', 'broken'],
                    'migration': ['migration', 'migrate', 'move', 'transfer', 'upgrade']
                };

                Object.keys(techKeywords).forEach(tech => {
                    if (searchTerm.includes(tech)) {
                        techKeywords[tech].forEach(keyword => {
                            if (itemText.includes(keyword)) score += 2;
                        });
                    }
                });

                // Common IT problem keywords get extra boost
                const problemKeywords = ['failed', 'error', 'not working', 'broken', 'slow', 'timeout', 'connection', 'access denied'];
                problemKeywords.forEach(problem => {
                    if (searchTerm.includes(problem) && itemText.includes(problem)) {
                        score += 2;
                    }
                });

                return score > 0;
            }).sort((a, b) => {
                // Sort by relevance score
                const scoreA = calculateRelevanceScore(a, searchTerm);
                const scoreB = calculateRelevanceScore(b, searchTerm);
                return scoreB - scoreA;
            });

            displayHubContent(filteredContent);
            
            if (query) {
                searchInput.value = query;
            }
        }

        function calculateRelevanceScore(item, searchTerm) {
            const searchWords = searchTerm.split(' ').filter(word => word.length > 2);
            const itemText = `${item.title} ${item.description} ${item.keywords}`.toLowerCase();
            let score = 0;

            searchWords.forEach(word => {
                if (itemText.includes(word)) {
                    if (item.title.toLowerCase().includes(word)) score += 3;
                    else if (item.keywords.toLowerCase().includes(word)) score += 2;
                    else if (item.description.toLowerCase().includes(word)) score += 1;
                }
            });

            return score;
        }

        // Clear search and return to default state
        function clearSearch() {
            const searchInput = document.getElementById('hub-search');
            searchInput.value = '';
            loadMicrosoftHub();
        }

        // Category filtering
        function switchCategory(category) {
            currentCategory = category;
            
            // Update active tab
            document.querySelectorAll('.category-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelector(`[data-category="${category}"]`).classList.add('active');

            // Filter content by category
            if (category === 'all') {
                // Don't show all content by default, show search interface
                loadMicrosoftHub();
            } else {
                const filteredContent = allHubContent.filter(article => 
                    article.category.toLowerCase().includes(category.toLowerCase())
                );
                displayHubContent(filteredContent);
            }
        }

        // Auto-refresh content periodically
        function setupHubAutoRefresh() {
            const lastUpdate = localStorage.getItem('hubLastUpdate');
            const twentyFourHours = 24 * 60 * 60 * 1000;
            
            if (!lastUpdate || (Date.now() - parseInt(lastUpdate)) > twentyFourHours) {
                loadMicrosoftHub();
            }
            
            setInterval(() => {
                loadMicrosoftHub();
            }, twentyFourHours);
        }

        // Add refresh button and search event listeners
        function initializeHub() {
            // Add refresh button
            const hubSection = document.getElementById('microsoft-hub');
            if (hubSection) {
                const refreshBtn = document.createElement('button');
                refreshBtn.className = 'hub-refresh-btn';
                refreshBtn.innerHTML = '<i data-feather="refresh-cw" class="w-4 h-4"></i>';
                refreshBtn.onclick = loadMicrosoftHub;
                refreshBtn.title = 'Refresh content';
                hubSection.style.position = 'relative';
                hubSection.appendChild(refreshBtn);
            }

            // Add search event listeners
            const searchInput = document.getElementById('hub-search');
            if (searchInput) {
                searchInput.addEventListener('input', () => searchHub());
                searchInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        searchHub();
                    }
                });
            }

            // Initialize feather icons
            if (typeof feather !== 'undefined') {
                feather.replace();
            }
        }

        // Load content when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Content loaded - blog posts removed
        });

        // IT Chatbot Functions
        function openITChatbot() {
            document.getElementById('it-chatbot-overlay').classList.remove('hidden');
            document.getElementById('chat-input').focus();
            if (typeof feather !== 'undefined') {
                feather.replace();
            }
        }

        function closeITChatbot() {
            document.getElementById('it-chatbot-overlay').classList.add('hidden');
        }

        function handleChatKeyPress(event) {
            if (event.key === 'Enter') {
                sendChatMessage();
            }
        }

        function askPredefinedQuestion(question) {
            document.getElementById('chat-input').value = question;
            sendChatMessage();
        }

        async function sendChatMessage() {
            const input = document.getElementById('chat-input');
            const message = input.value.trim();
            
            if (!message) return;
            
            // Add user message to chat and conversation history
            addMessageToChat(message, 'user');
            addToConversationHistory(message, 'user');
            input.value = '';
            
            // Show typing indicator
            addTypingIndicator();
            
            try {
                // First, try to find solutions in our knowledge base
                const localSolution = findLocalSolution(message);
                
                if (localSolution) {
                    removeTypingIndicator();
                    addMessageToChat(localSolution.response, 'bot', localSolution.links);
                    addToConversationHistory(localSolution.response, 'bot');
                } else {
                    // If no local solution, use free AI API with conversation context
                    const aiResponse = await getAIResponse(message);
                    removeTypingIndicator();
                    addMessageToChat(aiResponse, 'bot');
                    addToConversationHistory(aiResponse, 'bot');
                }
            } catch (error) {
                const errorMsg = "I'm having trouble connecting right now. Please check our IT Knowledge Hub above for solutions, or use the contact form for direct help.";
                removeTypingIndicator();
                addMessageToChat(errorMsg, 'bot');
                addToConversationHistory(errorMsg, 'bot');
            }
        }

        function findLocalSolution(question) {
            const lowerQuestion = question.toLowerCase();
            
            // IT Solution Database
            const solutions = {
                'azure backup': {
                    response: "🔧 **Azure Backup Issues Solution:**\n\n1. **Check Recovery Vault status**\n2. **Verify backup agent version**\n3. **Review network connectivity**\n4. **Check storage account permissions**\n\nFor detailed steps, check the official guide below:",
                    links: [{ text: "Azure Backup Troubleshooting Guide", url: "https://learn.microsoft.com/en-us/azure/backup/backup-azure-troubleshoot-vm-backup-fails-snapshot-timeout" }]
                },
                'powershell execution policy': {
                    response: "⚡ **PowerShell Execution Policy Fix:**\n\n1. **Run as Administrator:**\n   `Set-ExecutionPolicy RemoteSigned`\n\n2. **For current user only:**\n   `Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser`\n\n3. **Check current policy:**\n   `Get-ExecutionPolicy -List`",
                    links: [{ text: "PowerShell Execution Policies Documentation", url: "https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_execution_policies" }]
                },
                'exchange email delivery': {
                    response: "📧 **Email Delivery Issues Fix:**\n\n1. **Run Message Trace** in Exchange Admin Center\n2. **Check Mail Flow Rules**\n3. **Verify DNS MX records**\n4. **Review Transport Rules**\n5. **Check recipient permissions**",
                    links: [{ text: "Exchange Mail Flow Troubleshooting", url: "https://learn.microsoft.com/en-us/exchange/mail-flow-best-practices/troubleshoot-mail-flow" }]
                },
                'linux performance': {
                    response: "🐧 **Linux Performance Monitoring:**\n\n**Essential Commands:**\n• `top` - Real-time processes\n• `htop` - Enhanced process viewer\n• `iotop` - I/O monitoring\n• `vmstat` - System statistics\n• `free -h` - Memory usage\n• `df -h` - Disk usage",
                    links: [{ text: "Linux Performance Tools Guide", url: "https://www.redhat.com/en/topics/linux/linux-performance-monitoring-tools" }]
                },
                'dns resolution': {
                    response: "🌐 **DNS Resolution Problems:**\n\n1. **Clear DNS cache:** `ipconfig /flushdns`\n2. **Check DNS servers:** `nslookup`\n3. **Test connectivity:** `ping 8.8.8.8`\n4. **Verify DNS settings** in network adapter\n5. **Restart DNS service** if on server",
                    links: [{ text: "DNS Troubleshooting Guide", url: "https://learn.microsoft.com/en-us/windows-server/networking/dns/troubleshoot/troubleshoot-dns-client" }]
                },
                'network connectivity': {
                    response: "🔗 **Network Connectivity Troubleshooting:**\n\n**Step-by-step diagnosis:**\n1. `ping 127.0.0.1` (loopback)\n2. `ping [gateway]` (local network)\n3. `ping 8.8.8.8` (internet)\n4. `nslookup google.com` (DNS)\n5. `tracert [destination]` (routing)",
                    links: [{ text: "Network Troubleshooting Guide", url: "https://www.cisco.com/c/en/us/support/docs/ip/routing-information-protocol-rip/13769-5.html" }]
                }
            };
            
            // Find matching solution
            for (const [key, solution] of Object.entries(solutions)) {
                if (lowerQuestion.includes(key)) {
                    return solution;
                }
            }
            
            return null;
        }

        async function getAIResponse(message) {
            const conversationContext = getConversationContext();
            const contextPrompt = conversationContext ? `Previous conversation:\n${conversationContext}\n\n` : '';
            
            try {
                // Try multiple free AI APIs in order of preference
                
                // 1. Try OpenRouter (has free models)
                try {
                    const messages = [
                        {
                            role: 'system', 
                            content: `You are Sam's AI assistant with expert knowledge of his Microsoft cloud specialization. Sam has hands-on experience with Microsoft 365, Azure, Intune MDM, Exchange Online, PowerShell automation, and IT infrastructure. You should provide detailed, practical solutions based on Sam's expertise. Always be helpful, professional, and focus on Microsoft technologies. Include specific commands, scripts, or step-by-step instructions when relevant. Keep responses conversational and remember the context of our chat.`
                        }
                    ];
                    
                    // Add conversation history for context
                    if (conversationHistory.length > 0) {
                        conversationHistory.slice(-4).forEach(msg => {
                            messages.push({
                                role: msg.role,
                                content: msg.content
                            });
                        });
                    }
                    
                    messages.push({
                        role: 'user', 
                        content: message
                    });

                    const openRouterResponse = await fetch('https://openrouter.ai/api/v1/chat/completions', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'HTTP-Referer': window.location.href,
                            'X-Title': 'Sam Portfolio AI Assistant'
                        },
                        body: JSON.stringify({
                            model: 'microsoft/wizardlm-2-8x22b:free',
                            messages: messages,
                            max_tokens: 800,
                            temperature: 0.7
                        })
                    });

                    if (openRouterResponse.ok) {
                        const data = await openRouterResponse.json();
                        if (data.choices && data.choices[0] && data.choices[0].message) {
                            return data.choices[0].message.content;
                        }
                    }
                } catch (error) {
                    console.log('OpenRouter API unavailable, trying next option...');
                }

                // 2. Try Cohere AI (has free tier)
                try {
                    const cohereResponse = await fetch('https://api.cohere.ai/v1/generate', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': 'Bearer TRIAL-KEY', // Cohere allows trial usage
                        },
                        body: JSON.stringify({
                            model: 'command-light',
                            prompt: `You are Sam's AI assistant with expert knowledge of Microsoft cloud technologies. Sam specializes in Microsoft 365, Azure, Exchange Online, Intune, and PowerShell automation.

${contextPrompt}Current User Question: ${message}

Provide a helpful, detailed response based on Sam's Microsoft expertise:`,
                            max_tokens: 800,
                            temperature: 0.7,
                            return_likelihoods: 'NONE'
                        })
                    });

                    if (cohereResponse.ok) {
                        const data = await cohereResponse.json();
                        if (data.generations && data.generations[0]) {
                            return data.generations[0].text.trim();
                        }
                    }
                } catch (error) {
                    console.log('Cohere API unavailable, trying next option...');
                }

                // 3. Try Together AI (has free tier)
                try {
                    const togetherResponse = await fetch('https://api.together.xyz/inference', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            model: 'togethercomputer/RedPajama-INCITE-Chat-3B-v1',
                            prompt: `<human>: You are Sam's AI assistant specializing in Microsoft technologies. ${contextPrompt}Answer this question with expertise in Microsoft 365, Azure, Exchange Online, Intune, and PowerShell: ${message}\n<bot>:`,
                            max_tokens: 800,
                            temperature: 0.7,
                            top_p: 0.7,
                            top_k: 50,
                            repetition_penalty: 1,
                            stop: ['<human>:', '\n<human>:', '<|endoftext|>']
                        })
                    });

                    if (togetherResponse.ok) {
                        const data = await togetherResponse.json();
                        if (data.output && data.output.choices && data.output.choices[0]) {
                            return data.output.choices[0].text.trim();
                        }
                    }
                } catch (error) {
                    console.log('Together AI unavailable, trying next option...');
                }

                // 4. Try Hugging Face with better model and proper context
                try {
                    const hfResponse = await fetch('https://api-inference.huggingface.co/models/microsoft/DialoGPT-large', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            inputs: {
                                past_user_inputs: conversationHistory.filter(msg => msg.role === 'user').slice(-3).map(msg => msg.content),
                                generated_responses: conversationHistory.filter(msg => msg.role === 'assistant').slice(-3).map(msg => msg.content),
                                text: `As Sam's Microsoft cloud specialist AI assistant, please answer: ${message}`
                            },
                            parameters: {
                                max_length: 800,
                                min_length: 50,
                                temperature: 0.7,
                                do_sample: true,
                                top_p: 0.9
                            }
                        })
                    });

                    if (hfResponse.ok) {
                        const data = await hfResponse.json();
                        if (data.generated_text) {
                            return data.generated_text;
                        }
                    }
                } catch (error) {
                    console.log('Hugging Face API unavailable, using local knowledge...');
                }

            } catch (error) {
                console.log('All AI APIs unavailable, using Sam\'s knowledge base');
            }

            // Fallback to enhanced local knowledge base with context awareness
            return getSamAIResponse(message);
        }

        function getSamAIResponse(message) {
            const lowerMessage = message.toLowerCase();
            
            // Check conversation context for follow-up questions
            const recentContext = conversationHistory.slice(-4);
            const hasRecentPricingQuestion = recentContext.some(msg => 
                msg.content.toLowerCase().includes('licens') || 
                msg.content.toLowerCase().includes('price') || 
                msg.content.toLowerCase().includes('cost')
            );
            const hasRecentTechQuestion = recentContext.some(msg => 
                msg.content.toLowerCase().includes('powershell') || 
                msg.content.toLowerCase().includes('azure') || 
                msg.content.toLowerCase().includes('teams')
            );
            
            // Natural language processing for conversational responses
            const greetings = ['hello', 'hi', 'hey', 'good morning', 'good afternoon', 'good evening'];
            const thanks = ['thank', 'thanks', 'appreciate'];
            const goodbyes = ['bye', 'goodbye', 'see you', 'later'];
            const followUps = ['more', 'tell me more', 'explain', 'details', 'how', 'what about', 'can you'];
            
            // Check for follow-up questions with context
            if (followUps.some(follow => lowerMessage.includes(follow)) && lowerMessage.length < 50) {
                if (hasRecentPricingQuestion) {
                    return `💡 **More about Microsoft Licensing:**

**Additional Pricing Considerations:**
• **Volume Licensing**: Better rates for 250+ users
• **CSP vs Direct**: Cloud Solution Provider often offers better support
• **Seasonal Promotions**: Microsoft often runs Q4 promotions
• **Non-profit Discounts**: Up to 75% off for eligible organizations
• **Education Pricing**: Significant discounts for schools/universities

**Hidden Costs to Consider:**
• **Training & Adoption**: Budget 10-20% for user training
• **Migration Services**: Professional services for large migrations
• **Backup Solutions**: Third-party backup (Microsoft's is limited)
• **Compliance Add-ons**: Advanced compliance may require E5

**Pro Tips:**
• **Annual vs Monthly**: Annual saves ~16%
• **Mix Plans**: Not everyone needs E5 - mix E3/E5 strategically
• **Shared Mailboxes**: Free with any M365 plan
• **PowerBI**: Often cheaper as standalone vs E5

Want specific recommendations for your organization size? 🎯`;
                }
                
                if (hasRecentTechQuestion) {
                    return `🔧 **Let me provide more technical depth:**

**Advanced PowerShell Resources:**
• **Exchange Online Management**: \`Connect-ExchangeOnline\`
• **Azure AD Module**: \`Connect-AzureAD\`
• **Microsoft Graph**: \`Connect-MgGraph\`
• **Security & Compliance**: \`Connect-IPPSSession\`

**Common Admin Scenarios:**
• **Bulk User Operations**: CSV imports, license assignments
• **Security Auditing**: Sign-in logs, risky users, MFA status
• **Mail Flow Rules**: Transport rules, anti-spam policies
• **Conditional Access**: Location-based, device compliance

**Best Practices:**
• **Error Handling**: Always use try/catch blocks
• **Logging**: Write-Output for progress tracking
• **Credentials**: Use \`Get-Credential\` for security
• **Modules**: Keep PowerShell modules updated

What specific scenario would you like a script for? 💻`;
                }
            }
            
            // Check for greetings
            if (greetings.some(greeting => lowerMessage.includes(greeting))) {
                return `👋 Hello! I'm Sam's AI assistant, specialized in Microsoft cloud technologies. I can help you with:

• **Microsoft 365** (Teams, SharePoint, Exchange migrations)
• **Azure Cloud** (VMs, networking, security, cost optimization)
• **PowerShell automation** (scripts, administration, security)
• **Exchange Online** (mail flow, compliance, troubleshooting)
• **Intune & MDM** (device management, policies, security)
• **Licensing & pricing** (Australian market expertise)

What Microsoft challenge can I help you solve today? 🚀`;
            }
            
            // Check for thanks
            if (thanks.some(thank => lowerMessage.includes(thank))) {
                const responses = [
                    `😊 You're very welcome! I'm always here to help with any Microsoft-related questions or challenges.`,
                    `🙂 My pleasure! That's what I'm here for - making Microsoft tech easier to understand.`,
                    `😊 Glad I could help! Sam's experience really shines through these scenarios.`
                ];
                const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                
                return `${randomResponse}

Is there anything else about Microsoft 365, Azure, PowerShell, or IT administration that I can assist you with? Feel free to ask about specific scenarios, troubleshooting, or best practices! 💡`;
            }
            
            // Check for goodbyes
            if (goodbyes.some(goodbye => lowerMessage.includes(goodbye))) {
                return `👋 Goodbye! Feel free to come back anytime you need help with Microsoft technologies. Have a great day! 

Remember: I'm always here for your Microsoft 365, Azure, PowerShell, and cloud infrastructure questions. 🌟`;
            }
            
            // Check for unclear or very short questions
            if ((lowerMessage.includes('help') && lowerMessage.length < 20) || lowerMessage.length < 10) {
                return `🤔 I'd love to help! I'm Sam's AI assistant specializing in Microsoft technologies. Here are some example questions you could ask:

**Microsoft 365 & Exchange:**
• "How do I migrate mailboxes to Exchange Online?"
• "What are the best Teams governance policies?"
• "How to set up hybrid Exchange configuration?"

**Azure & Cloud:**
• "How to optimize Azure costs for small business?"
• "What's the best VM size for my workload?"
• "How to implement Azure security best practices?"

**PowerShell & Automation:**
• "Create a script to manage user permissions"
• "How to automate Office 365 license assignments?"
• "PowerShell commands for Exchange management"

**Licensing & Pricing:**
• "What Microsoft 365 plan should I choose?"
• "Azure pricing in Australia"
• "Compare E3 vs E5 licensing"

**Troubleshooting:**
• "User can't access SharePoint site"
• "Teams calls dropping frequently"
• "Slow computer performance issues"

What specific Microsoft challenge would you like help with? 🔧`;
            }
            
            // Microsoft Licensing & Pricing (Australia Focus)
            if (lowerMessage.includes('licens') || lowerMessage.includes('price') || lowerMessage.includes('cost') || lowerMessage.includes('australia')) {
                return `💰 **Microsoft Licensing & Pricing (Australia):**

**Microsoft 365 Business Plans (AUD Monthly):**
• **Microsoft 365 Business Basic**: ~$8.20 AUD/user/month
• **Microsoft 365 Business Standard**: ~$16.40 AUD/user/month  
• **Microsoft 365 Business Premium**: ~$28.60 AUD/user/month
• **Microsoft 365 Apps for Business**: ~$11.50 AUD/user/month

**Microsoft 365 Enterprise Plans:**
• **E3**: ~$30.00 AUD/user/month (full productivity + security)
• **E5**: ~$69.00 AUD/user/month (includes advanced security, analytics, voice)
• **F3 (Frontline)**: ~$6.00 AUD/user/month (for frontline workers)

**Azure Pricing (Australia East):**
• **B1s VM**: ~$0.0152 AUD/hour (~$11 AUD/month)
• **D2s v3 VM**: ~$0.155 AUD/hour (~$113 AUD/month)
• **Storage (LRS)**: ~$0.024 AUD/GB/month
• **Azure AD Premium P1**: ~$8.20 AUD/user/month

**Windows Server Licensing:**
• **Windows Server 2022 Standard**: ~$1,200 AUD (16 cores)
• **Windows Server 2022 Datacenter**: ~$8,000 AUD (16 cores)
• **SQL Server Standard**: ~$4,500 AUD/core
• **SQL Server Enterprise**: ~$18,000 AUD/core

**Exchange Online Plans:**
• **Exchange Online Plan 1**: ~$5.50 AUD/user/month
• **Exchange Online Plan 2**: ~$11.00 AUD/user/month

**Pro Tips for Australian Businesses:**
• Consider **CSP (Cloud Solution Provider)** pricing for better rates
• **Annual commitment** saves ~10-15%
• **Non-profit organizations** get significant discounts
• **Educational institutions** have special pricing

*Note: Prices vary by partner and commitment level. Contact Microsoft partners for exact quotes.*`;
            }

            // Windows Troubleshooting - Complete Solutions
            if (lowerMessage.includes('windows') && (lowerMessage.includes('slow') || lowerMessage.includes('performance'))) {
                return `🐌 **Windows Performance Issues - Complete Solution:**

**Immediate Performance Checks:**
1. **Check CPU & Memory Usage:**
   • Open Task Manager (Ctrl+Shift+Esc)
   • Look for high CPU/Memory processes
   • End unnecessary applications

2. **Disk Space & Health:**
   • Run Disk Cleanup: \`cleanmgr\`
   • Check disk health: \`chkdsk C: /f /r\`
   • Free up space: Delete temp files, downloads

3. **Startup Programs:**
   • Open Task Manager → Startup tab
   • Disable unnecessary startup programs
   • Focus on "High" impact programs

**Advanced Performance Optimization:**
4. **System File Check:**
   \`\`\`cmd
   sfc /scannow
   DISM /Online /Cleanup-Image /RestoreHealth
   \`\`\`

5. **Memory Diagnostic:**
   \`\`\`cmd
   mdsched.exe
   \`\`\`

6. **Registry Cleanup:**
   • Use built-in Registry Editor carefully
   • Consider CCleaner for automated cleanup

7. **Update Drivers:**
   • Device Manager → Update all drivers
   • Download latest GPU drivers
   • Windows Update for driver updates

**PowerShell Performance Commands:**
\`\`\`powershell
# Check system information
Get-ComputerInfo | Select-Object TotalPhysicalMemory, CsProcessors

# Find large files
Get-ChildItem C:\\ -Recurse -File | Sort-Object Length -Descending | Select-Object -First 10

# Check Windows services
Get-Service | Where-Object {$_.Status -eq "Running"} | Sort-Object Name
\`\`\`

**Long-term Solutions:**
• Upgrade to SSD if using HDD
• Add more RAM (8GB minimum, 16GB recommended)
• Regular maintenance schedule
• Keep Windows updated`;
            }

            if (lowerMessage.includes('password') && (lowerMessage.includes('reset') || lowerMessage.includes('forgot'))) {
                return `🔐 **Password Reset Solutions:**

**For End Users:**
1. **Self-Service Password Reset:**
   • Go to portal.office.com
   • Click "Can't access your account?"
   • Follow verification steps (phone/email)

2. **Windows Local Account:**
   • Boot from Windows installation media
   • Press Shift+F10 for command prompt
   • Use \`net user [username] [newpassword]\`

3. **Microsoft Account:**
   • Visit account.microsoft.com
   • Select "Sign-in options"
   • Choose "I forgot my password"

**For IT Administrators:**
4. **Azure AD Password Reset:**
   \`\`\`powershell
   Connect-AzureAD
   Set-AzureADUserPassword -ObjectId user@domain.com -Password (Read-Host -AsSecureString)
   \`\`\`

5. **On-Premises Active Directory:**
   \`\`\`powershell
   Set-ADAccountPassword -Identity username -Reset -NewPassword (Read-Host -AsSecureString)
   Set-ADUser -Identity username -ChangePasswordAtLogon $true
   \`\`\`

6. **Exchange Online Mailbox:**
   \`\`\`powershell
   Connect-ExchangeOnline
   Set-Mailbox -Identity user@domain.com -Password (Read-Host -AsSecureString)
   \`\`\`

**Security Best Practices:**
• Require password change on next login
• Enable multi-factor authentication
• Use complex password policies
• Monitor failed login attempts`;
            }

            // Microsoft 365 Administration
            if (lowerMessage.includes('teams') && (lowerMessage.includes('admin') || lowerMessage.includes('policy'))) {
                return `👥 **Microsoft Teams Administration:**

**Teams Policy Management:**
1. **Meeting Policies:**
   \`\`\`powershell
   Connect-MicrosoftTeams
   New-CsTeamsMeetingPolicy -Identity "SecureMeetings" -AllowAnonymousUsersToStartMeeting $false
   Grant-CsTeamsMeetingPolicy -Identity user@domain.com -PolicyName "SecureMeetings"
   \`\`\`

2. **Messaging Policies:**
   • Control chat, file sharing, reactions
   • Set retention policies
   • Configure external access

3. **App Permission Policies:**
   • Control which apps users can install
   • Block/allow specific apps
   • Custom app upload permissions

**Common Teams Administration Tasks:**
4. **User Management:**
   \`\`\`powershell
   # Add user to team
   Add-TeamUser -GroupId [TeamID] -User user@domain.com -Role Member

   # Create new team
   New-Team -DisplayName "Project Team" -Description "Project collaboration"
   \`\`\`

5. **Guest Access Configuration:**
   • Enable/disable guest access
   • Set guest permissions
   • Configure external sharing

6. **Phone System Setup:**
   • Assign phone numbers
   • Configure calling policies
   • Set up auto attendants

**Teams Analytics & Reporting:**
• Teams usage reports in admin center
• Call quality dashboard
• Teams advisor for deployment guidance`;
            }

            // Exchange Online Administration
            if (lowerMessage.includes('exchange') || lowerMessage.includes('email') || lowerMessage.includes('mailbox')) {
                return `📧 **Exchange Online Administration:**

**Mailbox Management:**
1. **Create New Mailboxes:**
   \`\`\`powershell
   Connect-ExchangeOnline
   New-Mailbox -Name "John Smith" -UserPrincipalName john@domain.com -Password (Read-Host -AsSecureString)
   \`\`\`

2. **Mailbox Permissions:**
   \`\`\`powershell
   # Grant full access
   Add-MailboxPermission -Identity john@domain.com -User admin@domain.com -AccessRights FullAccess

   # Grant send-as permission
   Add-RecipientPermission -Identity john@domain.com -Trustee admin@domain.com -AccessRights SendAs
   \`\`\`

3. **Calendar Permissions:**
   \`\`\`powershell
   Set-MailboxFolderPermission -Identity john@domain.com:\\Calendar -User admin@domain.com -AccessRights Editor
   \`\`\`

**Mail Flow & Transport Rules:**
4. **Anti-Spam Configuration:**
   • Configure spam filter policies
   • Set up quarantine settings
   • Create allowed/blocked sender lists

5. **Transport Rules:**
   \`\`\`powershell
   # External email warning
   New-TransportRule -Name "External Email Warning" -FromScope NotInOrganization -PrependSubject "[EXTERNAL]"

   # Block attachments
   New-TransportRule -Name "Block EXE Files" -AttachmentExtensionMatchesWords "exe,bat,cmd" -RejectMessageReasonText "Executable files not allowed"
   \`\`\`

**Migration & Hybrid:**
6. **Mailbox Migration:**
   • IMAP migration for external providers
   • Cutover migration for small organizations
   • Staged migration for large deployments
   • Hybrid configuration for gradual migration

**Troubleshooting Common Issues:**
• Message trace for delivery issues
• Connectivity analyzer tool
• SMTP authentication problems
• Mobile device synchronization`;
            }

            // Azure Administration
            if (lowerMessage.includes('azure') || lowerMessage.includes('vm') || lowerMessage.includes('virtual machine')) {
                return `☁️ **Azure Administration & Management:**

**Virtual Machine Management:**
1. **Create VM with PowerShell:**
   \`\`\`powershell
   # Connect to Azure
   Connect-AzAccount

   # Create resource group
   New-AzResourceGroup -Name "rg-production" -Location "Australia East"

   # Create VM
   New-AzVm -ResourceGroupName "rg-production" -Name "vm-web01" -Location "Australia East" -VirtualNetworkName "vnet-prod" -SubnetName "subnet-web" -SecurityGroupName "nsg-web" -PublicIpAddressName "pip-web01" -OpenPorts 80,443,3389
   \`\`\`

2. **VM Monitoring & Management:**
   • Enable Azure Monitor
   • Set up alerts for CPU/Memory
   • Configure backup policies
   • Implement update management

**Azure Active Directory:**
3. **User Management:**
   \`\`\`powershell
   Connect-AzureAD
   
   # Create new user
   New-AzureADUser -DisplayName "John Smith" -UserPrincipalName john@domain.onmicrosoft.com -PasswordProfile $passwordProfile -AccountEnabled $true

   # Add user to group
   Add-AzureADGroupMember -ObjectId [GroupID] -RefObjectId [UserID]
   \`\`\`

4. **Conditional Access Policies:**
   • Require MFA for admin accounts
   • Block access from untrusted locations
   • Device compliance requirements

**Cost Management:**
5. **Azure Cost Optimization:**
   • Use Azure Advisor recommendations
   • Implement auto-shutdown for dev VMs
   • Right-size virtual machines
   • Use reserved instances for production

6. **Resource Management:**
   • Proper resource tagging
   • Resource group organization
   • Azure Policy implementation
   • Resource locks for critical resources

**Security Best Practices:**
• Enable Azure Security Center
• Configure Key Vault for secrets
• Implement network security groups
• Regular security assessments`;
            }

            // SharePoint & OneDrive
            if (lowerMessage.includes('sharepoint') || lowerMessage.includes('onedrive')) {
                return `📁 **SharePoint & OneDrive Administration:**

**SharePoint Site Management:**
1. **Site Collection Creation:**
   \`\`\`powershell
   Connect-SPOService -Url https://tenant-admin.sharepoint.com
   New-SPOSite -Url https://tenant.sharepoint.com/sites/project -Owner admin@domain.com -StorageQuota 1024 -Title "Project Site"
   \`\`\`

2. **Permission Management:**
   • Use SharePoint groups instead of individual permissions
   • Implement least privilege principle
   • Regular permission audits

3. **Content Management:**
   • Document versioning settings
   • Content type management
   • Information management policies

**OneDrive Management:**
4. **OneDrive Policies:**
   \`\`\`powershell
   # Set default storage quota
   Set-SPOTenant -OneDriveStorageQuota 5120

   # Configure sharing settings
   Set-SPOTenant -DefaultSharingLinkType Internal
   \`\`\`

5. **Data Migration:**
   • SharePoint Migration Tool (SPMT)
   • Mover for bulk migrations
   • PowerShell for automated migrations

**Governance & Compliance:**
6. **Information Governance:**
   • Retention policies
   • Data loss prevention (DLP)
   • Sensitivity labels
   • eDiscovery configuration

**Troubleshooting Common Issues:**
• Sync client problems
• Permission inheritance issues
• Search service problems
• Workflow failures`;
            }

            // Windows Security & Troubleshooting
            if (lowerMessage.includes('virus') || lowerMessage.includes('malware') || lowerMessage.includes('security')) {
                return `🛡️ **Windows Security & Malware Removal:**

**Immediate Security Response:**
1. **Isolate the System:**
   • Disconnect from network immediately
   • Boot into Safe Mode if needed
   • Document what you observed

2. **Run Security Scans:**
   \`\`\`cmd
   # Windows Defender full scan
   "%ProgramFiles%\\Windows Defender\\MpCmdRun.exe" -Scan -ScanType 2

   # System file check
   sfc /scannow

   # Check system integrity
   DISM /Online /Cleanup-Image /ScanHealth
   \`\`\`

3. **Advanced Malware Removal:**
   • Use Microsoft Safety Scanner
   • Run Malwarebytes Anti-Malware
   • Use ESET Online Scanner
   • Check with Process Explorer

**Security Hardening:**
4. **Windows Security Configuration:**
   \`\`\`powershell
   # Enable Windows Defender features
   Set-MpPreference -EnableControlledFolderAccess Enabled
   Set-MpPreference -EnableNetworkProtection Enabled

   # Check Windows Update status
   Get-WUInstall -ListOnly
   \`\`\`

5. **User Account Control:**
   • Keep UAC enabled
   • Use standard user accounts for daily work
   • Admin accounts only for administrative tasks

6. **Network Security:**
   • Enable Windows Firewall
   • Disable unnecessary services
   • Regular security updates

**Prevention Strategies:**
• Regular system backups
• Employee security training
• Keep software updated
• Use standard user accounts
• Implement application whitelisting`;
            }

            // PowerShell & Automation
            if (lowerMessage.includes('powershell') || lowerMessage.includes('script') || lowerMessage.includes('automation')) {
                return `⚡ **PowerShell Automation & Scripting:**

**Essential PowerShell Commands:**
1. **System Information:**
   \`\`\`powershell
   # Computer information
   Get-ComputerInfo | Select-Object WindowsProductName, TotalPhysicalMemory

   # Disk space
   Get-WmiObject -Class Win32_LogicalDisk | Select-Object DeviceID, Size, FreeSpace

   # Running services
   Get-Service | Where-Object {$_.Status -eq "Running"}
   \`\`\`

2. **User & Group Management:**
   \`\`\`powershell
   # Local users
   Get-LocalUser
   New-LocalUser -Name "testuser" -Password (Read-Host -AsSecureString)

   # Active Directory users
   Get-ADUser -Filter * -Properties LastLogonDate | Select-Object Name, LastLogonDate
   \`\`\`

**Microsoft 365 PowerShell:**
3. **Exchange Online:**
   \`\`\`powershell
   Connect-ExchangeOnline
   Get-Mailbox | Select-Object DisplayName, PrimarySmtpAddress
   Set-MailboxPermission -Identity user@domain.com -User admin@domain.com -AccessRights FullAccess
   \`\`\`

4. **Teams Administration:**
   \`\`\`powershell
   Connect-MicrosoftTeams
   Get-Team | Select-Object DisplayName, GroupId
   New-Team -DisplayName "New Project Team"
   \`\`\`

**Azure PowerShell:**
5. **Azure Resource Management:**
   \`\`\`powershell
   Connect-AzAccount
   Get-AzVM | Select-Object Name, ResourceGroupName, Location
   Start-AzVM -ResourceGroupName "myRG" -Name "myVM"
   \`\`\`

**Automation Scripts:**
6. **Common Administrative Tasks:**
   • Bulk user creation from CSV
   • Automated backup scripts
   • System health monitoring
   • Software deployment automation

**Best Practices:**
• Always test scripts in dev environment
• Use proper error handling
• Document your scripts
• Version control with Git`;
            }

            // Network Troubleshooting
            if (lowerMessage.includes('network') || lowerMessage.includes('internet') || lowerMessage.includes('connectivity')) {
                return `🌐 **Network Connectivity Troubleshooting:**

**Basic Network Diagnostics:**
1. **Check Physical Connectivity:**
   • Verify cable connections
   • Check network adapter status
   • Test with different cable/port

2. **IP Configuration:**
   \`\`\`cmd
   ipconfig /all
   ipconfig /release
   ipconfig /renew
   ipconfig /flushdns
   \`\`\`

3. **DNS Resolution:**
   \`\`\`cmd
   nslookup google.com
   nslookup google.com 8.8.8.8
   ping 8.8.8.8
   ping google.com
   \`\`\`

**Advanced Network Testing:**
4. **Connectivity Testing:**
   \`\`\`cmd
   # Test route to destination
   tracert google.com
   
   # Test specific ports
   telnet google.com 80
   
   # Network statistics
   netstat -an | findstr :80
   \`\`\`

5. **Network Adapter Troubleshooting:**
   \`\`\`powershell
   # Reset network adapters
   netsh int ip reset
   netsh winsock reset
   
   # Disable and enable adapter
   Disable-NetAdapter -Name "Ethernet" -Confirm:$false
   Enable-NetAdapter -Name "Ethernet"
   \`\`\`

**Wireless Issues:**
6. **WiFi Troubleshooting:**
   \`\`\`cmd
   # Show wireless profiles
   netsh wlan show profiles
   
   # Connect to network
   netsh wlan connect name="NetworkName"
   
   # Reset wireless
   netsh wlan delete profile name="NetworkName"
   \`\`\`

**Corporate Network Issues:**
7. **Domain Connectivity:**
   \`\`\`cmd
   # Test domain connectivity
   nltest /dclist:domain.com
   
   # Check trust relationship
   nltest /sc_query:domain.com
   \`\`\`

**Tools for Advanced Diagnosis:**
• Wireshark for packet analysis
• PingPlotter for route analysis
• Network scanner tools
• Port scanner utilities`;
            }

            // General IT Support
            return `🔧 **General IT Support - Sam's AI Assistant:**

I'm Sam's comprehensive IT assistant! I can help with:

**💰 Licensing & Pricing:**
• Microsoft 365 plans and pricing (Australia specific)
• Azure cost estimates and optimization
• Windows Server and SQL licensing
• Comparison of different plans

**🖥️ Windows Support:**
• Performance issues and optimization
• Blue screen troubleshooting  
• Driver and hardware problems
• Security and malware removal

**☁️ Microsoft 365:**
• Exchange Online administration
• Teams management and policies
• SharePoint and OneDrive setup
• Security and compliance configuration

**🔧 Azure Cloud:**
• Virtual machine management
• Azure AD administration
• Cost optimization strategies
• Security best practices

**⚡ PowerShell & Automation:**
• Script examples for common tasks
• Microsoft 365 PowerShell
• Azure PowerShell management
• Automation solutions

**🌐 Network Issues:**
• Connectivity troubleshooting
• DNS and DHCP problems
• Wireless network issues
• Firewall configuration

**🛡️ Security:**
• Malware removal procedures
• Security hardening steps
• Multi-factor authentication setup
• Incident response guidance

**Just ask me anything specific!** For example:
• "How much does Microsoft 365 E3 cost in Australia?"
• "How to fix slow Windows performance?"
• "PowerShell script to reset passwords"
• "Azure VM won't start troubleshooting"

I can provide detailed solutions for any Microsoft ecosystem issue. Just describe:
- What exactly is the problem?
- When did it start?
- What error messages do you see?
- What have you tried already?

Ask me anything from basic user issues to complex infrastructure problems!`;
        }

        function addMessageToChat(message, sender, links = null) {
            const chatMessages = document.getElementById('chat-messages');
            const messageDiv = document.createElement('div');
            
            if (sender === 'user') {
                messageDiv.innerHTML = `
                    <div class="flex items-start gap-2 justify-end">
                        <div class="bg-emerald-600 text-white p-3 rounded-lg shadow-sm max-w-xs">
                            <p class="text-sm">${message}</p>
                        </div>
                        <div class="w-6 h-6 bg-gray-400 rounded-full flex items-center justify-center flex-shrink-0">
                            <i data-feather="user" class="w-3 h-3 text-white"></i>
                        </div>
                    </div>
                `;
            } else {
                let linksHtml = '';
                if (links) {
                    linksHtml = links.map(link => 
                        `<a href="${link.url}" target="_blank" class="inline-block mt-2 text-xs bg-blue-100 hover:bg-blue-200 text-blue-700 px-2 py-1 rounded transition-colors">${link.text} →</a>`
                    ).join(' ');
                }
                
                messageDiv.innerHTML = `
                    <div class="flex items-start gap-2">
                        <div class="w-6 h-6 bg-emerald-600 rounded-full flex items-center justify-center flex-shrink-0">
                            <i data-feather="cpu" class="w-3 h-3 text-white"></i>
                        </div>
                        <div class="bg-white p-3 rounded-lg shadow-sm max-w-xs">
                            <p class="text-sm text-gray-800 whitespace-pre-line">${message}</p>
                            ${linksHtml}
                        </div>
                    </div>
                `;
            }
            
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            if (typeof feather !== 'undefined') {
                feather.replace();
            }
        }

        function addTypingIndicator() {
            const chatMessages = document.getElementById('chat-messages');
            const typingDiv = document.createElement('div');
            typingDiv.id = 'typing-indicator';
            typingDiv.innerHTML = `
                <div class="flex items-start gap-2">
                    <div class="w-6 h-6 bg-emerald-600 rounded-full flex items-center justify-center flex-shrink-0">
                        <i data-feather="cpu" class="w-3 h-3 text-white"></i>
                    </div>
                    <div class="bg-white p-3 rounded-lg shadow-sm">
                        <div class="flex space-x-1">
                            <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce"></div>
                            <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 0.1s"></div>
                            <div class="w-2 h-2 bg-gray-400 rounded-full animate-bounce" style="animation-delay: 0.2s"></div>
                        </div>
                    </div>
                </div>
            `;
            chatMessages.appendChild(typingDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            
            if (typeof feather !== 'undefined') {
                feather.replace();
            }
        }

        function removeTypingIndicator() {
            const typingIndicator = document.getElementById('typing-indicator');
            if (typingIndicator) {
                typingIndicator.remove();
            }
        }

        // Close chatbot when clicking outside
        document.addEventListener('click', function(event) {
            const chatbotOverlay = document.getElementById('it-chatbot-overlay');
            if (event.target === chatbotOverlay) {
                closeITChatbot();
            }
        });

        // Auto-changing text for Quick IT Help button
        function startHelpButtonAnimation() {
            const helpTexts = [
                "Quick IT Help",
                "Ask: Azure issues?",
                "Ask: Exchange problems?", 
                "Ask: Network down?",
                "Ask: PowerShell errors?",
                "Ask: Linux performance?",
                "Ask: Security breach?",
                "Ask: Server crashes?",
                "Ask: Docker issues?",
                "Ask: Azure optimization?",
                "Ask: Backup failures?",
                "Ask: Any IT question!"
            ];
            
            let currentIndex = 0;
            const desktopButton = document.getElementById('help-button-text');
            const mobileButton = document.getElementById('mobile-help-button-text');
            
            setInterval(() => {
                currentIndex = (currentIndex + 1) % helpTexts.length;
                if (desktopButton) desktopButton.textContent = helpTexts[currentIndex];
                if (mobileButton) mobileButton.textContent = helpTexts[currentIndex];
            }, 3000); // Change every 3 seconds
        }

        // Cloud service information popup
        function showCloudInfo(service) {
            const services = {
                azure: {
                    title: "Microsoft Azure",
                    description: "Azure is Microsoft's comprehensive cloud computing platform that provides:\n\n• Virtual Machines and App Services\n• AI and Machine Learning tools\n• Storage and Database solutions\n• Networking and Security services\n• Developer tools and DevOps\n\nPerfect for enterprises already using Microsoft products.",
                },
                m365: {
                    title: "Microsoft 365",
                    description: "Microsoft 365 is a complete productivity suite that includes:\n\n• Office applications (Word, Excel, PowerPoint)\n• Teams for collaboration and communication\n• SharePoint for document management\n• Exchange Online for email\n• OneDrive for cloud storage\n• Advanced security and compliance tools\n\nIdeal for organizations seeking integrated productivity solutions.",
                }
            };
            
            const info = services[service];
            if (info) {
                alert(`${info.title}\n\n${info.description}`);
            }
        }

        // Initialize button animation when page loads
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(startHelpButtonAnimation, 2000); // Start after 2 seconds
        });
    </script>
</body>
</html>
