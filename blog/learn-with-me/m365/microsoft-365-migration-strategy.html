<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Microsoft 365 Migration: Complete Strategy Guide 2025 | Sam in Cloud</title>
    
    <!-- Security Headers -->
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
    <meta name="description" content="Comprehensive guide to Microsoft 365 migration strategies, planning, execution, and best practices for enterprise environments.">
    <meta name="robots" content="index, follow">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/feather-icons"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
        
        body {
            font-family: 'Poppins', sans-serif;
        }
        
        .hero-bg {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }
        
        .code-container {
            position: relative;
        }
        
        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.2s;
        }
        
        .copy-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .blog-image {
            max-width: 100%;
            height: auto;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            margin: 20px 0;
        }
        
        .info-box {
            background: linear-gradient(135deg, #10b98120, #05966920);
            border-left: 4px solid #10b981;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .warning-box {
            background: linear-gradient(135deg, rgba(245, 158, 11, 0.2), rgba(217, 119, 6, 0.2));
            border-left: 4px solid #f59e0b;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .timeline {
            position: relative;
            padding-left: 30px;
        }
        
        .timeline::before {
            content: '';
            position: absolute;
            left: 15px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: #10b981;
        }
        
        .timeline-item {
            position: relative;
            margin-bottom: 30px;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .timeline-item::before {
            content: '';
            position: absolute;
            left: -37px;
            top: 25px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #10b981;
            border: 3px solid white;
            box-shadow: 0 0 0 3px #10b981;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Navigation -->
    <nav class="bg-white/95 backdrop-blur-lg fixed w-full z-50 shadow-lg border-b border-gray-200/50">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16 items-center">
                <a href="../../../index.html" class="text-xl font-bold text-gray-800 tracking-tight">Sam in Cloud</a>
                <div class="flex items-center space-x-6">
                    <a href="../../index.html" class="text-gray-600 hover:text-gray-900 transition-colors duration-200 font-medium">Blog</a>
                    <a href="../../../index.html#contact" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg font-semibold transition-all duration-200">Contact</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero-bg pt-24 pb-16">
        <div class="max-w-4xl mx-auto px-6 text-center">
            <div class="flex items-center justify-center gap-3 mb-6">
                <i data-feather="move" class="w-12 h-12 text-white"></i>
                <h1 class="text-4xl md:text-5xl font-bold text-white">Microsoft 365 Migration Strategy</h1>
            </div>
            <p class="text-xl text-green-100 mb-8 max-w-3xl mx-auto">
                Complete guide to planning, executing, and optimizing Microsoft 365 migrations for enterprise environments
            </p>
            <div class="flex items-center justify-center gap-6 text-green-200">
                <span class="flex items-center gap-2">
                    <i data-feather="calendar" class="w-4 h-4"></i>
                    October 7, 2025
                </span>
                <span class="flex items-center gap-2">
                    <i data-feather="clock" class="w-4 h-4"></i>
                    18 min read
                </span>
                <span class="flex items-center gap-2">
                    <i data-feather="user" class="w-4 h-4"></i>
                    Sam Adhikari
                </span>
            </div>
        </div>
    </section>

    <!-- Main Content -->
    <article class="max-w-4xl mx-auto px-6 py-12">
        <!-- Introduction -->
        <div class="prose prose-lg max-w-none">
            <img src="https://images.unsplash.com/photo-1553877522-43269d4ea984?auto=format&fit=crop&w=1200&q=80" alt="Microsoft 365 Migration Planning" class="blog-image">
            
            <p class="text-lg text-gray-700 leading-relaxed mb-8">
                Migrating to Microsoft 365 is a critical transformation that affects every aspect of your organization's productivity and collaboration. This comprehensive guide provides a proven methodology for successful M365 migrations, covering everything from initial planning to post-migration optimization.
            </p>
        </div>

        <!-- Migration Phases Timeline -->
        <section class="mb-16">
            <h2 class="text-3xl font-bold text-gray-800 mb-8 flex items-center gap-3">
                <i data-feather="calendar" class="w-8 h-8 text-green-600"></i>
                Migration Timeline & Phases
            </h2>

            <img src="https://images.unsplash.com/photo-1611224923853-80b023f02d71?auto=format&fit=crop&w=1200&q=80" alt="Migration Timeline" class="blog-image">

            <div class="timeline">
                <div class="timeline-item">
                    <h3 class="text-xl font-bold text-gray-800 mb-3">Phase 1: Assessment & Planning (2-4 weeks)</h3>
                    <ul class="text-gray-700 space-y-2">
                        <li>• Current environment discovery and analysis</li>
                        <li>• User and data inventory</li>
                        <li>• Migration strategy selection</li>
                        <li>• Risk assessment and mitigation planning</li>
                    </ul>
                </div>

                <div class="timeline-item">
                    <h3 class="text-xl font-bold text-gray-800 mb-3">Phase 2: Preparation & Configuration (3-6 weeks)</h3>
                    <ul class="text-gray-700 space-y-2">
                        <li>• M365 tenant setup and configuration</li>
                        <li>• Domain verification and DNS configuration</li>
                        <li>• Security and compliance settings</li>
                        <li>• Pilot group selection and testing</li>
                    </ul>
                </div>

                <div class="timeline-item">
                    <h3 class="text-xl font-bold text-gray-800 mb-3">Phase 3: Pilot Migration (2-3 weeks)</h3>
                    <ul class="text-gray-700 space-y-2">
                        <li>• Small group migration and testing</li>
                        <li>• User experience validation</li>
                        <li>• Process refinement</li>
                        <li>• Training material development</li>
                    </ul>
                </div>

                <div class="timeline-item">
                    <h3 class="text-xl font-bold text-gray-800 mb-3">Phase 4: Production Migration (4-12 weeks)</h3>
                    <ul class="text-gray-700 space-y-2">
                        <li>• Staged user migration in batches</li>
                        <li>• Data migration and synchronization</li>
                        <li>• User training and support</li>
                        <li>• Monitoring and troubleshooting</li>
                    </ul>
                </div>

                <div class="timeline-item">
                    <h3 class="text-xl font-bold text-gray-800 mb-3">Phase 5: Optimization & Adoption (2-4 weeks)</h3>
                    <ul class="text-gray-700 space-y-2">
                        <li>• Performance optimization</li>
                        <li>• Advanced feature rollout</li>
                        <li>• User adoption tracking</li>
                        <li>• Legacy system decommissioning</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Pre-Migration Assessment -->
        <section class="mb-16">
            <h2 class="text-3xl font-bold text-gray-800 mb-6 flex items-center gap-3">
                <i data-feather="search" class="w-8 h-8 text-green-600"></i>
                Pre-Migration Assessment
            </h2>

            <img src="https://images.unsplash.com/photo-1460925895917-afdab827c52f?auto=format&fit=crop&w=1200&q=80" alt="Assessment Dashboard" class="blog-image">

            <p class="text-gray-700 mb-6">
                A thorough assessment is the foundation of a successful migration. Use PowerShell scripts to inventory your current environment and identify potential migration challenges.
            </p>

            <div class="code-container mb-6">
                <button class="copy-btn" onclick="copyToClipboard('assessment-script')">
                    <i data-feather="copy" class="w-3 h-3 inline mr-1"></i>Copy
                </button>
                <pre id="assessment-script"><code class="language-powershell"># Microsoft 365 Migration Assessment Script
function Invoke-M365MigrationAssessment {
    param(
        [string]$ExchangeServer,
        [string]$OutputPath = "./M365-Assessment-Report.html"
    )

    Write-Output "Starting Microsoft 365 Migration Assessment..."
    
    $assessment = @{
        AssessmentDate = Get-Date
        Environment = @{}
        Users = @()
        MailboxData = @()
        PublicFolders = @()
        Recommendations = @()
    }

    # Connect to Exchange On-Premises
    if ($ExchangeServer) {
        $session = New-PSSession -ConfigurationName Microsoft.Exchange -ConnectionUri "http://$ExchangeServer/PowerShell/"
        Import-PSSession $session -DisableNameChecking
    }

    # Environment Discovery
    Write-Output "Discovering Exchange environment..."
    $assessment.Environment = @{
        ExchangeVersion = (Get-ExchangeServer)[0].AdminDisplayVersion
        ServerCount = (Get-ExchangeServer).Count
        DatabaseCount = (Get-MailboxDatabase).Count
        TotalMailboxes = (Get-Mailbox -ResultSize Unlimited).Count
        PublicFolderMailboxes = (Get-PublicFolderMailbox).Count
    }

    # Mailbox Analysis
    Write-Output "Analyzing mailboxes..."
    $mailboxes = Get-Mailbox -ResultSize Unlimited
    foreach ($mailbox in $mailboxes) {
        $stats = Get-MailboxStatistics $mailbox.Identity
        $assessment.MailboxData += @{
            DisplayName = $mailbox.DisplayName
            PrimarySmtpAddress = $mailbox.PrimarySmtpAddress
            MailboxSizeGB = [math]::Round(($stats.TotalItemSize.Value.ToBytes() / 1GB), 2)
            ItemCount = $stats.ItemCount
            LastLogonTime = $stats.LastLogonTime
            MailboxType = $mailbox.RecipientTypeDetails
        }
    }

    # Large Mailbox Identification
    $largeMailboxes = $assessment.MailboxData | Where-Object {$_.MailboxSizeGB -gt 50}
    if ($largeMailboxes.Count -gt 0) {
        $assessment.Recommendations += "Found $($largeMailboxes.Count) mailboxes larger than 50GB. Consider archiving or chunked migration."
    }

    # Inactive Users
    $inactiveUsers = $assessment.MailboxData | Where-Object {
        $_.LastLogonTime -lt (Get-Date).AddDays(-90) -or $_.LastLogonTime -eq $null
    }
    if ($inactiveUsers.Count -gt 0) {
        $assessment.Recommendations += "Found $($inactiveUsers.Count) users inactive for 90+ days. Consider cleanup before migration."
    }

    # Public Folder Analysis
    Write-Output "Analyzing public folders..."
    $pfMailboxes = Get-PublicFolderMailbox
    foreach ($pfmb in $pfMailboxes) {
        $pfStats = Get-PublicFolderMailboxStatistics $pfmb.Identity
        $assessment.PublicFolders += @{
            Name = $pfmb.Name
            SizeGB = [math]::Round(($pfStats.TotalItemSize.Value.ToBytes() / 1GB), 2)
            ItemCount = $pfStats.ItemCount
        }
    }

    # Generate HTML Report
    $html = @"
<!DOCTYPE html>
<html>
<head>
    <title>Microsoft 365 Migration Assessment</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .header { background: linear-gradient(135deg, #10b981, #059669); color: white; padding: 30px; border-radius: 10px; margin-bottom: 30px; }
        .section { margin: 30px 0; }
        .stat-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin: 20px 0; }
        .stat-card { background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #10b981; }
        .stat-value { font-size: 2em; font-weight: bold; color: #10b981; }
        .table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        .table th, .table td { padding: 12px; text-align: left; border-bottom: 1px solid #ddd; }
        .table th { background-color: #f8f9fa; font-weight: 600; }
        .recommendation { background: #fff3cd; border: 1px solid #ffeaa7; padding: 15px; border-radius: 5px; margin: 10px 0; }
        .large-mailbox { background: #f8d7da; }
        .inactive-user { background: #d1ecf1; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Microsoft 365 Migration Assessment Report</h1>
            <p>Assessment completed on: $($assessment.AssessmentDate)</p>
        </div>

        <div class="section">
            <h2>Environment Overview</h2>
            <div class="stat-grid">
                <div class="stat-card">
                    <div class="stat-value">$($assessment.Environment.TotalMailboxes)</div>
                    <div>Total Mailboxes</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">$($assessment.Environment.DatabaseCount)</div>
                    <div>Mailbox Databases</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">$($assessment.Environment.ServerCount)</div>
                    <div>Exchange Servers</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">$($assessment.Environment.PublicFolderMailboxes)</div>
                    <div>Public Folder Mailboxes</div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>Migration Recommendations</h2>
"@

    foreach ($recommendation in $assessment.Recommendations) {
        $html += "<div class='recommendation'>$recommendation</div>"
    }

    $html += @"
        </div>

        <div class="section">
            <h2>Large Mailboxes (>50GB)</h2>
            <table class="table">
                <thead>
                    <tr>
                        <th>User</th>
                        <th>Email</th>
                        <th>Size (GB)</th>
                        <th>Item Count</th>
                        <th>Last Logon</th>
                    </tr>
                </thead>
                <tbody>
"@

    foreach ($mailbox in ($assessment.MailboxData | Where-Object {$_.MailboxSizeGB -gt 50} | Sort-Object MailboxSizeGB -Descending)) {
        $html += @"
                    <tr class="large-mailbox">
                        <td>$($mailbox.DisplayName)</td>
                        <td>$($mailbox.PrimarySmtpAddress)</td>
                        <td>$($mailbox.MailboxSizeGB)</td>
                        <td>$($mailbox.ItemCount)</td>
                        <td>$($mailbox.LastLogonTime)</td>
                    </tr>
"@
    }

    $html += "</tbody></table></div></div></body></html>"
    
    $html | Out-File -FilePath $OutputPath -Encoding UTF8
    
    # Cleanup
    if ($session) {
        Remove-PSSession $session
    }
    
    Write-Output "Assessment completed. Report saved to: $OutputPath"
    return $assessment
}

# Example usage
$assessment = Invoke-M365MigrationAssessment -ExchangeServer "exchange01.company.com"</code></pre>
            </div>

            <div class="info-box">
                <h3 class="text-lg font-semibold text-gray-800 mb-2 flex items-center gap-2">
                    <i data-feather="info" class="w-5 h-5 text-green-600"></i>
                    Assessment Checklist
                </h3>
                <ul class="text-gray-700 space-y-1">
                    <li>• Current Exchange version and configuration</li>
                    <li>• Mailbox sizes and item counts</li>
                    <li>• Public folder inventory</li>
                    <li>• Third-party integrations</li>
                    <li>• Network bandwidth and latency</li>
                    <li>• Compliance and retention requirements</li>
                </ul>
            </div>
        </section>

        <!-- Migration Strategies -->
        <section class="mb-16">
            <h2 class="text-3xl font-bold text-gray-800 mb-6 flex items-center gap-3">
                <i data-feather="shuffle" class="w-8 h-8 text-green-600"></i>
                Migration Strategies
            </h2>

            <img src="https://images.unsplash.com/photo-1552664730-d307ca884978?auto=format&fit=crop&w=1200&q=80" alt="Migration Strategies" class="blog-image">

            <div class="grid md:grid-cols-2 gap-8 mb-8">
                <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-200">
                    <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                        <i data-feather="zap" class="w-6 h-6 text-green-600"></i>
                        Cutover Migration
                    </h3>
                    <p class="text-gray-700 mb-4">Best for organizations with fewer than 150 mailboxes.</p>
                    <ul class="text-gray-600 space-y-2 text-sm">
                        <li>• All mailboxes migrate simultaneously</li>
                        <li>• Minimal complexity</li>
                        <li>• Single weekend cutover</li>
                        <li>• No coexistence period</li>
                    </ul>
                </div>

                <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-200">
                    <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                        <i data-feather="layers" class="w-6 h-6 text-green-600"></i>
                        Staged Migration
                    </h3>
                    <p class="text-gray-700 mb-4">For Exchange 2003/2007 environments with up to 2,000 mailboxes.</p>
                    <ul class="text-gray-600 space-y-2 text-sm">
                        <li>• Migrate in batches over time</li>
                        <li>• Directory synchronization required</li>
                        <li>• Coexistence period</li>
                        <li>• More complex but flexible</li>
                    </ul>
                </div>

                <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-200">
                    <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                        <i data-feather="git-branch" class="w-6 h-6 text-green-600"></i>
                        Hybrid Migration
                    </h3>
                    <p class="text-gray-700 mb-4">For Exchange 2010+ with any number of mailboxes.</p>
                    <ul class="text-gray-600 space-y-2 text-sm">
                        <li>• Long-term coexistence</li>
                        <li>• Flexible migration pace</li>
                        <li>• Rich coexistence features</li>
                        <li>• Most complex setup</li>
                    </ul>
                </div>

                <div class="bg-white p-6 rounded-lg shadow-lg border border-gray-200">
                    <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center gap-2">
                        <i data-feather="package" class="w-6 h-6 text-green-600"></i>
                        Third-Party Tools
                    </h3>
                    <p class="text-gray-700 mb-4">For complex environments or specific requirements.</p>
                    <ul class="text-gray-600 space-y-2 text-sm">
                        <li>• Advanced migration features</li>
                        <li>• Cross-platform support</li>
                        <li>• Detailed reporting</li>
                        <li>• Additional cost</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Hybrid Configuration -->
        <section class="mb-16">
            <h2 class="text-3xl font-bold text-gray-800 mb-6 flex items-center gap-3">
                <i data-feather="link" class="w-8 h-8 text-green-600"></i>
                Hybrid Configuration Setup
            </h2>

            <img src="https://images.unsplash.com/photo-1518186285589-2f7649de83e0?auto=format&fit=crop&w=1200&q=80" alt="Hybrid Configuration" class="blog-image">

            <p class="text-gray-700 mb-6">
                The Hybrid Configuration Wizard (HCW) simplifies the setup of Exchange hybrid deployments. Here's how to configure it properly:
            </p>

            <div class="code-container mb-6">
                <button class="copy-btn" onclick="copyToClipboard('hybrid-setup')">
                    <i data-feather="copy" class="w-3 h-3 inline mr-1"></i>Copy
                </button>
                <pre id="hybrid-setup"><code class="language-powershell"># Exchange Hybrid Configuration Prerequisites Check
function Test-HybridPrerequisites {
    Write-Output "Checking Exchange Hybrid Prerequisites..."
    
    $prerequisites = @{
        ExchangeVersion = $null
        InternetConnectivity = $false
        CertificateValid = $false
        DNSRecords = @()
        FirewallPorts = @()
        Results = @()
    }
    
    # Check Exchange Version
    $exchangeServer = Get-ExchangeServer | Where-Object {$_.ServerRole -like "*ClientAccess*"} | Select-Object -First 1
    $prerequisites.ExchangeVersion = $exchangeServer.AdminDisplayVersion
    
    if ($exchangeServer.AdminDisplayVersion.Major -ge 14) {
        $prerequisites.Results += "✓ Exchange version supported for hybrid"
    } else {
        $prerequisites.Results += "✗ Exchange version not supported. Minimum Exchange 2010 SP3 required"
    }
    
    # Test Internet Connectivity
    try {
        $connection = Test-NetConnection -ComputerName "outlook.office365.com" -Port 443
        if ($connection.TcpTestSucceeded) {
            $prerequisites.InternetConnectivity = $true
            $prerequisites.Results += "✓ Internet connectivity to Office 365 verified"
        }
    } catch {
        $prerequisites.Results += "✗ Cannot reach Office 365 endpoints"
    }
    
    # Check SSL Certificate
    $casServers = Get-ClientAccessServer
    foreach ($cas in $casServers) {
        try {
            $cert = Get-ExchangeCertificate -Server $cas.Name | Where-Object {$_.Services -like "*IIS*"} | Select-Object -First 1
            if ($cert.NotAfter -gt (Get-Date).AddDays(30)) {
                $prerequisites.CertificateValid = $true
                $prerequisites.Results += "✓ Valid SSL certificate found on $($cas.Name)"
            } else {
                $prerequisites.Results += "⚠ SSL certificate on $($cas.Name) expires soon: $($cert.NotAfter)"
            }
        } catch {
            $prerequisites.Results += "✗ Could not verify SSL certificate on $($cas.Name)"
        }
    }
    
    # DNS Record Verification
    $autodiscoverRecord = Resolve-DnsName -Name "autodiscover.$((Get-AcceptedDomain | Where-Object {$_.Default}).DomainName)" -ErrorAction SilentlyContinue
    if ($autodiscoverRecord) {
        $prerequisites.Results += "✓ Autodiscover DNS record found"
    } else {
        $prerequisites.Results += "✗ Autodiscover DNS record missing"
    }
    
    # Required Firewall Ports
    $requiredPorts = @(
        @{Port = 25; Description = "SMTP"},
        @{Port = 443; Description = "HTTPS"},
        @{Port = 587; Description = "SMTP Submission"}
    )
    
    foreach ($portTest in $requiredPorts) {
        try {
            $test = Test-NetConnection -ComputerName "outlook.office365.com" -Port $portTest.Port
            if ($test.TcpTestSucceeded) {
                $prerequisites.Results += "✓ Port $($portTest.Port) ($($portTest.Description)) connectivity verified"
            }
        } catch {
            $prerequisites.Results += "✗ Port $($portTest.Port) ($($portTest.Description)) connectivity failed"
        }
    }
    
    return $prerequisites
}

# Run Hybrid Configuration Wizard
function Start-HybridConfiguration {
    param(
        [string]$TenantDomain,
        [string]$OnPremisesDomain,
        [PSCredential]$O365Credential
    )
    
    Write-Output "Starting Hybrid Configuration..."
    
    # Download and run HCW
    $hcwPath = "$env:TEMP\HybridConfigurationWizard.msi"
    
    try {
        # Note: In practice, download HCW from Microsoft
        Write-Output "Downloading Hybrid Configuration Wizard..."
        # Invoke-WebRequest -Uri "https://aka.ms/hybridwizard" -OutFile $hcwPath
        
        # Install HCW
        # Start-Process -FilePath "msiexec.exe" -ArgumentList "/i $hcwPath /quiet" -Wait
        
        # Configure hybrid parameters
        $hybridConfig = @{
            OnPremisesSmtpDomain = $OnPremisesDomain
            TenantDomain = $TenantDomain
            ExchangeOnlineCredential = $O365Credential
            CentralizedTransport = $true
            SecureMailEnabled = $true
            FreeBusyEnabled = $true
        }
        
        Write-Output "Hybrid configuration parameters:"
        $hybridConfig | Format-Table -AutoSize
        
        # The actual HCW execution would happen here
        Write-Output "Run the Hybrid Configuration Wizard with these parameters:"
        Write-Output "- On-premises domain: $OnPremisesDomain"
        Write-Output "- Tenant domain: $TenantDomain"
        Write-Output "- Enable centralized mail transport: Yes"
        Write-Output "- Enable secure mail: Yes"
        Write-Output "- Enable free/busy sharing: Yes"
        
    } catch {
        Write-Error "Failed to configure hybrid: $($_.Exception.Message)"
    }
}

# Example usage
$prereqs = Test-HybridPrerequisites
$prereqs.Results | ForEach-Object { Write-Output $_ }

# $cred = Get-Credential -Message "Enter Office 365 Global Admin credentials"
# Start-HybridConfiguration -TenantDomain "company.onmicrosoft.com" -OnPremisesDomain "company.com" -O365Credential $cred</code></pre>
            </div>

            <div class="warning-box">
                <h3 class="text-lg font-semibold text-gray-800 mb-2 flex items-center gap-2">
                    <i data-feather="alert-triangle" class="w-5 h-5 text-orange-600"></i>
                    Important Considerations
                </h3>
                <ul class="text-gray-700 space-y-1">
                    <li>• Ensure Exchange CU is up to date before running HCW</li>
                    <li>• Use a dedicated service account for hybrid connector</li>
                    <li>• Plan for certificate renewal procedures</li>
                    <li>• Test mail flow in both directions</li>
                </ul>
            </div>
        </section>

        <!-- User Migration Batching -->
        <section class="mb-16">
            <h2 class="text-3xl font-bold text-gray-800 mb-6 flex items-center gap-3">
                <i data-feather="users" class="w-8 h-8 text-green-600"></i>
                User Migration Batching Strategy
            </h2>

            <img src="https://images.unsplash.com/photo-1600880292203-757bb62b4baf?auto=format&fit=crop&w=1200&q=80" alt="User Migration Batching" class="blog-image">

            <p class="text-gray-700 mb-6">
                Effective batching ensures smooth migration with minimal user impact. Group users strategically based on departments, locations, and technical requirements.
            </p>

            <div class="code-container mb-6">
                <button class="copy-btn" onclick="copyToClipboard('migration-batching')">
                    <i data-feather="copy" class="w-3 h-3 inline mr-1"></i>Copy
                </button>
                <pre id="migration-batching"><code class="language-powershell"># Migration Batch Management Script
function New-MigrationBatch {
    param(
        [string]$BatchName,
        [array]$UserList,
        [string]$TargetDeliveryDomain,
        [datetime]$StartTime,
        [int]$BadItemLimit = 50,
        [int]$LargeItemLimit = 20
    )
    
    Write-Output "Creating migration batch: $BatchName"
    Write-Output "Users in batch: $($UserList.Count)"
    
    # Create CSV file for batch
    $csvPath = ".\$BatchName-Users.csv"
    $userObjects = @()
    
    foreach ($user in $UserList) {
        $mailbox = Get-Mailbox $user -ErrorAction SilentlyContinue
        if ($mailbox) {
            $stats = Get-MailboxStatistics $mailbox.Identity
            $userObjects += [PSCustomObject]@{
                EmailAddress = $mailbox.PrimarySmtpAddress
                DisplayName = $mailbox.DisplayName
                Department = $mailbox.Department
                MailboxSizeGB = [math]::Round(($stats.TotalItemSize.Value.ToBytes() / 1GB), 2)
                ItemCount = $stats.ItemCount
                LastLogonTime = $stats.LastLogonTime
            }
        }
    }
    
    # Export to CSV for migration batch
    $migrationCsv = $userObjects | Select-Object EmailAddress | Export-Csv -Path $csvPath -NoTypeInformation
    
    # Create migration batch
    try {
        $batch = New-MigrationBatch -Name $BatchName -CSVData ([System.IO.File]::ReadAllBytes($csvPath)) `
            -TargetDeliveryDomain $TargetDeliveryDomain -BadItemLimit $BadItemLimit `
            -LargeItemLimit $LargeItemLimit -StartAfter $StartTime -AutoStart
        
        Write-Output "Migration batch created successfully:"
        Write-Output "  Batch Name: $($batch.Identity)"
        Write-Output "  Status: $($batch.Status)"
        Write-Output "  Total Users: $($batch.TotalCount)"
        Write-Output "  Start Time: $($batch.StartAfter)"
        
        return $batch
    } catch {
        Write-Error "Failed to create migration batch: $($_.Exception.Message)"
    }
}

# Monitor Migration Progress
function Monitor-MigrationBatch {
    param([string]$BatchName)
    
    do {
        $batch = Get-MigrationBatch $BatchName
        $users = Get-MigrationUser -BatchId $batch.Identity
        
        $completed = ($users | Where-Object {$_.Status -eq "Completed"}).Count
        $failed = ($users | Where-Object {$_.Status -eq "Failed"}).Count
        $inProgress = ($users | Where-Object {$_.Status -eq "Syncing"}).Count
        $total = $users.Count
        
        $percentComplete = if ($total -gt 0) { [math]::Round(($completed / $total) * 100, 1) } else { 0 }
        
        Clear-Host
        Write-Output "Migration Batch: $BatchName"
        Write-Output "Overall Status: $($batch.Status)"
        Write-Output "Progress: $percentComplete% ($completed/$total completed)"
        Write-Output ""
        Write-Output "Detailed Status:"
        Write-Output "  Completed: $completed"
        Write-Output "  In Progress: $inProgress"
        Write-Output "  Failed: $failed"
        Write-Output ""
        
        if ($failed -gt 0) {
            Write-Output "Failed Migrations:"
            $failedUsers = $users | Where-Object {$_.Status -eq "Failed"} | Select-Object Identity, ErrorSummary
            $failedUsers | Format-Table -AutoSize
        }
        
        # Check for large items
        $largeItemUsers = $users | Where-Object {$_.SkippedItemCount -gt 0}
        if ($largeItemUsers) {
            Write-Output "Users with skipped items:"
            $largeItemUsers | Select-Object Identity, SkippedItemCount | Format-Table -AutoSize
        }
        
        Start-Sleep -Seconds 300  # Check every 5 minutes
        
    } while ($batch.Status -eq "Syncing")
    
    Write-Output "Migration batch completed with status: $($batch.Status)"
}

# Example: Create migration batches by department
$departments = @("IT", "Finance", "Sales", "Marketing", "HR")
$batchCounter = 1

foreach ($dept in $departments) {
    $deptUsers = Get-Mailbox -Filter "Department -eq '$dept'" | Select-Object -ExpandProperty PrimarySmtpAddress
    
    if ($deptUsers.Count -gt 0) {
        $batchName = "Batch$batchCounter-$dept"
        $startTime = (Get-Date).AddDays($batchCounter - 1)  # Stagger batch starts
        
        New-MigrationBatch -BatchName $batchName -UserList $deptUsers `
            -TargetDeliveryDomain "company.mail.onmicrosoft.com" -StartTime $startTime
        
        $batchCounter++
    }
}</code></pre>
            </div>

            <div class="info-box">
                <h3 class="text-lg font-semibold text-gray-800 mb-2 flex items-center gap-2">
                    <i data-feather="info" class="w-5 h-5 text-green-600"></i>
                    Batching Best Practices
                </h3>
                <ul class="text-gray-700 space-y-1">
                    <li>• Start with IT department for early issue identification</li>
                    <li>• Keep batch sizes between 50-150 users</li>
                    <li>• Schedule migrations during off-hours</li>
                    <li>• Include power users in early batches for feedback</li>
                    <li>• Plan for weekend schedules for large mailboxes</li>
                </ul>
            </div>
        </section>

        <!-- Post-Migration Tasks -->
        <section class="mb-16">
            <h2 class="text-3xl font-bold text-gray-800 mb-6 flex items-center gap-3">
                <i data-feather="check-circle" class="w-8 h-8 text-green-600"></i>
                Post-Migration Optimization
            </h2>

            <img src="https://images.unsplash.com/photo-1560472354-b33ff0c44a43?auto=format&fit=crop&w=1200&q=80" alt="Post Migration Optimization" class="blog-image">

            <p class="text-gray-700 mb-6">
                After migration completion, focus on optimization, user adoption, and advanced feature rollout to maximize your M365 investment.
            </p>

            <div class="code-container mb-6">
                <button class="copy-btn" onclick="copyToClipboard('post-migration')">
                    <i data-feather="copy" class="w-3 h-3 inline mr-1"></i>Copy
                </button>
                <pre id="post-migration"><code class="language-powershell"># Post-Migration Optimization and Adoption Script
function Invoke-PostMigrationOptimization {
    param(
        [string]$TenantDomain,
        [string]$ReportPath = "./Post-Migration-Report.html"
    )
    
    Write-Output "Starting post-migration optimization..."
    
    # Connect to Exchange Online
    Connect-ExchangeOnline -UserPrincipalName "admin@$TenantDomain"
    
    $report = @{
        OptimizationDate = Get-Date
        UserAdoption = @()
        SecurityConfig = @()
        PerformanceMetrics = @()
        Recommendations = @()
    }
    
    # User Adoption Analysis
    Write-Output "Analyzing user adoption..."
    $mailboxes = Get-Mailbox -ResultSize Unlimited
    foreach ($mailbox in $mailboxes) {
        $stats = Get-MailboxStatistics $mailbox.Identity
        $lastActivity = (Get-MailboxFolderStatistics $mailbox.Identity -FolderScope Inbox | Select-Object -First 1).LastItemAdded
        
        $daysSinceLastActivity = if ($lastActivity) { 
            (Get-Date) - $lastActivity 
        } else { 
            [TimeSpan]::MaxValue 
        }
        
        $report.UserAdoption += @{
            User = $mailbox.DisplayName
            Email = $mailbox.PrimarySmtpAddress
            LastActivity = $lastActivity
            DaysSinceActivity = $daysSinceLastActivity.Days
            AdoptionStatus = if ($daysSinceLastActivity.Days -le 7) { "Active" } 
                            elseif ($daysSinceLastActivity.Days -le 30) { "Moderate" } 
                            else { "Inactive" }
        }
    }
    
    # Security Configuration Check
    Write-Output "Checking security configuration..."
    
    # MFA Status
    try {
        Connect-MgGraph -Scopes "UserAuthenticationMethod.Read.All"
        $users = Get-MgUser -All
        $mfaEnabled = 0
        $mfaDisabled = 0
        
        foreach ($user in $users) {
            $authMethods = Get-MgUserAuthenticationMethod -UserId $user.Id
            if ($authMethods.Count -gt 1) {  # More than just password
                $mfaEnabled++
            } else {
                $mfaDisabled++
            }
        }
        
        $report.SecurityConfig += @{
            Setting = "Multi-Factor Authentication"
            EnabledUsers = $mfaEnabled
            DisabledUsers = $mfaDisabled
            CompliancePercentage = [math]::Round(($mfaEnabled / ($mfaEnabled + $mfaDisabled)) * 100, 1)
        }
    } catch {
        Write-Warning "Could not retrieve MFA status: $($_.Exception.Message)"
    }
    
    # ATP Configuration
    $atpPolicies = Get-AtpPolicyForO365
    $report.SecurityConfig += @{
        Setting = "Advanced Threat Protection"
        Status = if ($atpPolicies) { "Enabled" } else { "Disabled" }
        Policies = $atpPolicies.Count
    }
    
    # DLP Policies
    $dlpPolicies = Get-DlpPolicy
    $report.SecurityConfig += @{
        Setting = "Data Loss Prevention"
        Status = if ($dlpPolicies) { "Configured" } else { "Not Configured" }
        Policies = $dlpPolicies.Count
    }
    
    # Performance Metrics
    Write-Output "Gathering performance metrics..."
    
    # Mail flow statistics
    $messageTrace = Get-MessageTrace -StartDate (Get-Date).AddDays(-7) -EndDate (Get-Date)
    $totalMessages = $messageTrace.Count
    $deliveredMessages = ($messageTrace | Where-Object {$_.Status -eq "Delivered"}).Count
    $deliveryRate = if ($totalMessages -gt 0) { [math]::Round(($deliveredMessages / $totalMessages) * 100, 2) } else { 0 }
    
    $report.PerformanceMetrics += @{
        Metric = "Email Delivery Rate (7 days)"
        Value = "$deliveryRate%"
        Details = "$deliveredMessages of $totalMessages messages delivered"
    }
    
    # Storage utilization
    $totalStorageGB = ($mailboxes | ForEach-Object { 
        $stats = Get-MailboxStatistics $_.Identity
        [math]::Round(($stats.TotalItemSize.Value.ToBytes() / 1GB), 2)
    } | Measure-Object -Sum).Sum
    
    $averageMailboxSizeGB = [math]::Round($totalStorageGB / $mailboxes.Count, 2)
    
    $report.PerformanceMetrics += @{
        Metric = "Total Storage Utilization"
        Value = "$totalStorageGB GB"
        Details = "Average mailbox size: $averageMailboxSizeGB GB"
    }
    
    # Generate Recommendations
    $inactiveUsers = ($report.UserAdoption | Where-Object {$_.AdoptionStatus -eq "Inactive"}).Count
    if ($inactiveUsers -gt 0) {
        $report.Recommendations += "Consider user training for $inactiveUsers inactive users"
    }
    
    $mfaCompliance = ($report.SecurityConfig | Where-Object {$_.Setting -eq "Multi-Factor Authentication"}).CompliancePercentage
    if ($mfaCompliance -lt 95) {
        $report.Recommendations += "Increase MFA adoption from $mfaCompliance% to 95%+"
    }
    
    if (-not ($report.SecurityConfig | Where-Object {$_.Setting -eq "Advanced Threat Protection" -and $_.Status -eq "Enabled"})) {
        $report.Recommendations += "Enable Advanced Threat Protection for enhanced security"
    }
    
    # Generate HTML Report
    $html = @"
<!DOCTYPE html>
<html>
<head>
    <title>Post-Migration Optimization Report</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 20px; background: #f5f5f5; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .header { background: linear-gradient(135deg, #10b981, #059669); color: white; padding: 30px; border-radius: 10px; margin-bottom: 30px; }
        .section { margin: 30px 0; }
        .metric-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin: 20px 0; }
        .metric-card { background: #f8f9fa; padding: 20px; border-radius: 8px; border-left: 4px solid #10b981; }
        .metric-value { font-size: 1.5em; font-weight: bold; color: #10b981; }
        .adoption-active { color: #28a745; }
        .adoption-moderate { color: #ffc107; }
        .adoption-inactive { color: #dc3545; }
        .recommendation { background: #d4edda; border: 1px solid #c3e6cb; padding: 15px; border-radius: 5px; margin: 10px 0; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Post-Migration Optimization Report</h1>
            <p>Report generated on: $($report.OptimizationDate)</p>
        </div>

        <div class="section">
            <h2>User Adoption Summary</h2>
            <div class="metric-grid">
"@

    $activeUsers = ($report.UserAdoption | Where-Object {$_.AdoptionStatus -eq "Active"}).Count
    $moderateUsers = ($report.UserAdoption | Where-Object {$_.AdoptionStatus -eq "Moderate"}).Count
    $inactiveUsersCount = ($report.UserAdoption | Where-Object {$_.AdoptionStatus -eq "Inactive"}).Count

    $html += @"
                <div class="metric-card">
                    <div class="metric-value adoption-active">$activeUsers</div>
                    <div>Active Users (Last 7 days)</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value adoption-moderate">$moderateUsers</div>
                    <div>Moderate Users (Last 30 days)</div>
                </div>
                <div class="metric-card">
                    <div class="metric-value adoption-inactive">$inactiveUsersCount</div>
                    <div>Inactive Users (30+ days)</div>
                </div>
            </div>
        </div>

        <div class="section">
            <h2>Performance Metrics</h2>
            <div class="metric-grid">
"@

    foreach ($metric in $report.PerformanceMetrics) {
        $html += @"
                <div class="metric-card">
                    <div class="metric-value">$($metric.Value)</div>
                    <div>$($metric.Metric)</div>
                    <small>$($metric.Details)</small>
                </div>
"@
    }

    $html += @"
            </div>
        </div>

        <div class="section">
            <h2>Optimization Recommendations</h2>
"@

    foreach ($recommendation in $report.Recommendations) {
        $html += "<div class='recommendation'>$recommendation</div>"
    }

    $html += "</div></div></body></html>"
    
    $html | Out-File -FilePath $ReportPath -Encoding UTF8
    
    Write-Output "Post-migration optimization report saved to: $ReportPath"
    return $report
}

# Example usage
$optimization = Invoke-PostMigrationOptimization -TenantDomain "company.onmicrosoft.com"</code></pre>
            </div>
        </section>

        <!-- Conclusion -->
        <section class="mb-16">
            <h2 class="text-3xl font-bold text-gray-800 mb-6">Migration Success Factors</h2>
            <div class="bg-gradient-to-r from-green-50 to-blue-50 p-8 rounded-lg border border-green-200">
                <div class="grid md:grid-cols-2 gap-8">
                    <div>
                        <h3 class="text-xl font-bold text-gray-800 mb-4">Critical Success Factors</h3>
                        <ul class="text-gray-700 space-y-2">
                            <li>• Thorough planning and assessment</li>
                            <li>• Stakeholder buy-in and communication</li>
                            <li>• Proper testing and pilot phases</li>
                            <li>• Comprehensive user training</li>
                            <li>• Continuous monitoring and optimization</li>
                        </ul>
                    </div>
                    <div>
                        <h3 class="text-xl font-bold text-gray-800 mb-4">Common Pitfalls to Avoid</h3>
                        <ul class="text-gray-700 space-y-2">
                            <li>• Insufficient bandwidth planning</li>
                            <li>• Ignoring legacy integrations</li>
                            <li>• Poor change management</li>
                            <li>• Inadequate security configuration</li>
                            <li>• Lack of post-migration support</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- Call to Action -->
        <div class="bg-white rounded-lg p-8 shadow-lg border border-gray-200 text-center">
            <h3 class="text-2xl font-bold text-gray-800 mb-4">Planning Your Microsoft 365 Migration?</h3>
            <p class="text-gray-600 mb-6">Let's discuss your migration strategy and ensure a smooth transition to Microsoft 365.</p>
            <a href="../../../index.html#contact" class="inline-flex items-center gap-2 bg-green-600 hover:bg-green-700 text-white px-8 py-3 rounded-lg font-semibold transition-all duration-200">
                <i data-feather="mail" class="w-4 h-4"></i>
                Get Migration Consultation
            </a>
        </div>
    </article>

    <!-- Navigation -->
    <div class="max-w-4xl mx-auto px-6 pb-12">
        <div class="flex justify-between items-center bg-white rounded-lg p-6 shadow-lg border border-gray-200">
            <a href="/blog/index.html" class="flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors">
                <i data-feather="arrow-left" class="w-4 h-4"></i>
                <span>Back to Blog</span>
            </a>
            <a href="/index.html" class="flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors">
                <span>Home</span>
                <i data-feather="home" class="w-4 h-4"></i>
            </a>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-800 text-gray-300 py-8 mt-16">
        <div class="max-w-4xl mx-auto px-6 text-center">
            <p>© 2025 Sam Adhikari • Cloud Solutions Specialist</p>
        </div>
    </footer>

    <script>
        feather.replace();
        
        function copyToClipboard(elementId) {
            const element = document.getElementById(elementId);
            const text = element.innerText;
            navigator.clipboard.writeText(text).then(function() {
                const btn = element.parentElement.querySelector('.copy-btn');
                const originalText = btn.innerHTML;
                btn.innerHTML = '<i data-feather="check" class="w-3 h-3 inline mr-1"></i>Copied!';
                feather.replace();
                setTimeout(() => {
                    btn.innerHTML = originalText;
                    feather.replace();
                }, 2000);
            });
        }
    </script>
</body>
</html>