<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Grant calendar permissions via PowerShell</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-b from-sky-900 via-sky-800 to-indigo-900 text-white min-h-screen">
  <header class="max-w-6xl mx-auto p-6 flex justify-between items-center">
    <a href="../../index.html" class="text-xl font-semibold">Sam Adhikari</a>
    <a href="../index.html" class="text-sm text-white/80 hover:underline">Blog</a>
  </header>

  <main class="max-w-3xl mx-auto p-6 bg-white/5 rounded-lg">
    <nav class="text-sm text-teal-200 mb-4">
      <a href="../../index.html" class="hover:underline">Blog</a> ›
      <a href="../exchange/index.html" class="hover:underline"> Exchange</a> ›
      <span class="opacity-80">Grant calendar permissions via PowerShell</span>
    </nav>

    <h1 class="text-3xl font-bold text-white">Grant calendar permissions via PowerShell</h1>
    <p class="text-teal-200 mt-2">Quick examples for granting calendar folder permissions using Exchange Online / Microsoft 365 PowerShell — single mailbox and bulk CSV examples.</p>

    <article class="mt-6 prose prose-invert text-teal-100">
      <h2>Overview</h2>
      <p>There are scenarios where admins or automation need to grant another user access to a mailbox calendar (read or editor). This post shows safe PowerShell examples for Exchange Online and a bulk flow using a CSV file.</p>

      <h3>Prerequisites</h3>
      <ul>
        <li>An account with the required Exchange admin privileges.</li>
        <li>Exchange Online PowerShell module (ExchangeOnlineManagement) or the correct Graph permissions for delegated calendar access.</li>
      </ul>

      <h3>Connect to Exchange Online</h3>
      <pre><code class="language-powershell"># Install if needed
Install-Module ExchangeOnlineManagement -Scope CurrentUser

# Connect interactively
Import-Module ExchangeOnlineManagement
Connect-ExchangeOnline -UserPrincipalName admin@contoso.com
</code></pre>

      <h3>Grant permission to a single mailbox</h3>
      <p>Grant the user <code>Reviewer</code> (read-only) on the default calendar folder:</p>
      <pre><code class="language-powershell">Add-MailboxFolderPermission -Identity 'alice@contoso.com:\Calendar' -User 'bob@contoso.com' -AccessRights Reviewer</code></pre>

      <p>To grant Editor (read/write):</p>
      <pre><code class="language-powershell">Add-MailboxFolderPermission -Identity 'alice@contoso.com:\Calendar' -User 'bob@contoso.com' -AccessRights Editor</code></pre>

      <h3>Bulk update from CSV</h3>
      <p>CSV format: <code>Mailbox,Principal,AccessRight</code></p>
      <pre><code class="language-csv">Mailbox,Principal,AccessRight
alice@contoso.com,bob@contoso.com,Reviewer
jane@contoso.com,helpdesk@contoso.com,Editor
</code></pre>

      <pre><code class="language-powershell">$csv = Import-Csv -Path .\calendar-permissions.csv
foreach ($row in $csv) {
    try {
        Write-Host "Granting $($row.AccessRight) on $($row.Mailbox) to $($row.Principal)"
        Add-MailboxFolderPermission -Identity "$($row.Mailbox):\Calendar" -User $row.Principal -AccessRights $row.AccessRight -ErrorAction Stop
    } catch {
        Write-Warning "Failed for $($row.Mailbox) -> $($_.Exception.Message)"
    }
}
</code></pre>

      <h3>Verify and remove</h3>
      <pre><code class="language-powershell"># List permissions
Get-MailboxFolderPermission -Identity 'alice@contoso.com:\Calendar'

# Remove a permission
Remove-MailboxFolderPermission -Identity 'alice@contoso.com:\Calendar' -User 'bob@contoso.com'
</code></pre>

      <h3>Notes</h3>
      <ul>
        <li>For modern Graph-based automation you can grant application or delegated roles, but mailbox folder permissions are often easiest via Exchange cmdlets.</li>
        <li>Always test on a small set of mailboxes before bulk updating production mailboxes.</li>
      </ul>
    </article>

    <p class="mt-6"><a href="../exchange/index.html" class="text-blue-300 hover:underline">Back to Exchange posts</a></p>
  </main>

  <footer class="text-center p-6 text-sm text-white/70">© 2025 Sam Adhikari</footer>
</body>
</html>
