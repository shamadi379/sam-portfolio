<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Grant Calendar Permissions via PowerShell | Sam in Cloud</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/feather-icons"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.css" rel="stylesheet" />
  
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');
    body {
      font-family: 'Poppins', sans-serif;
    }
    
    /* Enhanced background */
    .blog-bg {
      background: linear-gradient(135deg, #047857 0%, #059669 50%, #0d9488 100%);
      min-height: 100vh;
    }
    
    /* Code block styling */
    .code-container {
      position: relative;
      background: #1e293b;
      border-radius: 0.75rem;
      border: 1px solid #334155;
      margin: 1.5rem 0;
      overflow: hidden;
    }
    
    .code-header {
      background: #0f172a;
      padding: 0.75rem 1rem;
      border-bottom: 1px solid #334155;
      display: flex;
      justify-content: between;
      align-items: center;
    }
    
    .code-language {
      color: #10b981;
      font-size: 0.875rem;
      font-weight: 500;
    }
    
    /* Custom copy button */
    .copy-btn {
      position: absolute;
      top: 0.75rem;
      right: 0.75rem;
      background: #374151;
      border: 1px solid #4b5563;
      color: #d1d5db;
      padding: 0.5rem;
      border-radius: 0.375rem;
      cursor: pointer;
      transition: all 0.2s;
      font-size: 0.75rem;
      display: flex;
      align-items: center;
      gap: 0.25rem;
    }
    
    .copy-btn:hover {
      background: #4b5563;
      border-color: #10b981;
    }
    
    .copy-btn.copied {
      background: #10b981;
      border-color: #10b981;
    }
    
    /* Prism overrides for better styling */
    pre[class*="language-"] {
      background: transparent !important;
      margin: 0 !important;
      padding: 1rem !important;
      overflow-x: auto;
    }
    
    code[class*="language-"] {
      background: transparent !important;
      font-size: 0.875rem;
      line-height: 1.5;
    }
    
    /* Article styling */
    .prose h2 {
      color: #ffffff;
      font-size: 1.5rem;
      font-weight: 700;
      margin-top: 2rem;
      margin-bottom: 1rem;
      border-bottom: 2px solid #10b981;
      padding-bottom: 0.5rem;
    }
    
    .prose h3 {
      color: #d1fae5;
      font-size: 1.25rem;
      font-weight: 600;
      margin-top: 1.5rem;
      margin-bottom: 0.75rem;
    }
    
    .prose p {
      color: #d1d5db;
      line-height: 1.7;
      margin-bottom: 1rem;
    }
    
    .prose ul {
      color: #d1d5db;
      margin: 1rem 0;
      padding-left: 1.5rem;
    }
    
    .prose li {
      margin-bottom: 0.5rem;
    }
    
    .prose code:not([class*="language-"]) {
      background: #374151;
      color: #10b981;
      padding: 0.125rem 0.375rem;
      border-radius: 0.25rem;
      font-size: 0.875rem;
    }
  </style>
</head>
<body class="blog-bg">
  <!-- Navigation -->
  <nav class="bg-emerald-800/90 backdrop-blur-lg shadow-lg border-b border-emerald-700/20">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between h-16 items-center">
        <a href="../../../../index.html" class="text-xl font-bold text-white tracking-tight">Sam in Cloud</a>
        <div class="flex items-center space-x-6">
          <a href="../../../index.html" class="text-emerald-100 hover:text-white transition-colors duration-200 font-medium">Blog</a>
          <a href="../../../../index.html#contact" class="bg-emerald-600 hover:bg-emerald-500 text-white px-4 py-2 rounded-lg font-semibold transition-all duration-200">Contact</a>
        </div>
      </div>
    </div>
  </nav>

  <main class="max-w-4xl mx-auto p-6 mt-8">
    <!-- Breadcrumb -->
    <nav class="text-sm text-emerald-200 mb-6 bg-white/10 backdrop-blur-sm rounded-lg p-3">
      <div class="flex items-center space-x-2">
        <a href="../../../index.html" class="hover:text-white transition-colors">Blog</a>
        <i data-feather="chevron-right" class="w-4 h-4"></i>
        <a href="../index.html" class="hover:text-white transition-colors">Exchange</a>
        <i data-feather="chevron-right" class="w-4 h-4"></i>
        <span class="text-white font-medium">Grant Calendar Permissions</span>
      </div>
    </nav>

    <!-- Article Header -->
    <header class="mb-8 bg-white/10 backdrop-blur-sm rounded-xl p-8 border border-white/20">
      <div class="flex items-start gap-4 mb-4">
        <div class="p-3 bg-emerald-600 rounded-lg">
          <i data-feather="calendar" class="w-6 h-6 text-white"></i>
        </div>
        <div class="flex-1">
          <h1 class="text-3xl md:text-4xl font-bold text-white mb-3">Grant Calendar Permissions via PowerShell</h1>
          <p class="text-xl text-emerald-100 leading-relaxed">Quick examples for granting calendar folder permissions using Exchange Online / Microsoft 365 PowerShell — single mailbox and bulk CSV examples.</p>
        </div>
      </div>
      
      <div class="flex flex-wrap gap-4 text-sm">
        <div class="flex items-center gap-2 text-emerald-200">
          <i data-feather="clock" class="w-4 h-4"></i>
          <span>5 min read</span>
        </div>
        <div class="flex items-center gap-2 text-emerald-200">
          <i data-feather="tag" class="w-4 h-4"></i>
          <span>Exchange Online</span>
        </div>
        <div class="flex items-center gap-2 text-emerald-200">
          <i data-feather="calendar" class="w-4 h-4"></i>
          <span>October 2025</span>
        </div>
      </div>
    </header>

    <!-- Article Content -->
    <article class="bg-white/10 backdrop-blur-sm rounded-xl p-8 border border-white/20 prose prose-lg max-w-none">
      <h2>Overview</h2>
      <p>There are scenarios where admins or automation need to grant another user access to a mailbox calendar (read or editor). This post shows safe PowerShell examples for Exchange Online and a bulk flow using a CSV file.</p>

      <h3>Prerequisites</h3>
      <ul>
        <li>An account with the required Exchange admin privileges</li>
        <li>Exchange Online PowerShell module (ExchangeOnlineManagement) or the correct Graph permissions for delegated calendar access</li>
        <li>PowerShell 5.1 or PowerShell 7+ with appropriate execution policy</li>
      </ul>

      <h3>Connect to Exchange Online</h3>
      <p>First, install and connect to Exchange Online PowerShell:</p>
      
      <div class="code-container">
        <div class="code-header">
          <span class="code-language">PowerShell</span>
          <button class="copy-btn" onclick="copyCode(this)">
            <i data-feather="copy" class="w-4 h-4"></i>
            <span>Copy</span>
          </button>
        </div>
        <pre><code class="language-powershell"># Install if needed
Install-Module ExchangeOnlineManagement -Scope CurrentUser

# Connect interactively
Import-Module ExchangeOnlineManagement
Connect-ExchangeOnline -UserPrincipalName admin@contoso.com</code></pre>
      </div>

      <h3>Grant permission to a single mailbox</h3>
      <p>Grant the user <code>Reviewer</code> (read-only) access on the default calendar folder:</p>
      
      <div class="code-container">
        <div class="code-header">
          <span class="code-language">PowerShell</span>
          <button class="copy-btn" onclick="copyCode(this)">
            <i data-feather="copy" class="w-4 h-4"></i>
            <span>Copy</span>
          </button>
        </div>
        <pre><code class="language-powershell">Add-MailboxFolderPermission -Identity 'alice@contoso.com:\Calendar' -User 'bob@contoso.com' -AccessRights Reviewer</code></pre>
      </div>

      <p>To grant <code>Editor</code> (read/write) permissions:</p>
      
      <div class="code-container">
        <div class="code-header">
          <span class="code-language">PowerShell</span>
          <button class="copy-btn" onclick="copyCode(this)">
            <i data-feather="copy" class="w-4 h-4"></i>
            <span>Copy</span>
          </button>
        </div>
        <pre><code class="language-powershell">Add-MailboxFolderPermission -Identity 'alice@contoso.com:\Calendar' -User 'bob@contoso.com' -AccessRights Editor</code></pre>
      </div>

      <h3>Bulk update from CSV</h3>
      <p>For bulk operations, create a CSV file with the following format:</p>
      
      <div class="code-container">
        <div class="code-header">
          <span class="code-language">CSV</span>
          <button class="copy-btn" onclick="copyCode(this)">
            <i data-feather="copy" class="w-4 h-4"></i>
            <span>Copy</span>
          </button>
        </div>
        <pre><code class="language-csv">Mailbox,Principal,AccessRight
alice@contoso.com,bob@contoso.com,Reviewer
jane@contoso.com,helpdesk@contoso.com,Editor
manager@contoso.com,assistant@contoso.com,Editor</code></pre>
      </div>

      <p>Then use this PowerShell script to process the CSV file:</p>
      
      <div class="code-container">
        <div class="code-header">
          <span class="code-language">PowerShell</span>
          <button class="copy-btn" onclick="copyCode(this)">
            <i data-feather="copy" class="w-4 h-4"></i>
            <span>Copy</span>
          </button>
        </div>
        <pre><code class="language-powershell">$csv = Import-Csv -Path .\calendar-permissions.csv
foreach ($row in $csv) {
    try {
        Write-Host "Granting $($row.AccessRight) on $($row.Mailbox) to $($row.Principal)" -ForegroundColor Green
        Add-MailboxFolderPermission -Identity "$($row.Mailbox):\Calendar" -User $row.Principal -AccessRights $row.AccessRight -ErrorAction Stop
        Write-Host "✓ Success" -ForegroundColor Green
    } catch {
        Write-Warning "❌ Failed for $($row.Mailbox) -> $($_.Exception.Message)"
    }
}</code></pre>
      </div>

      <h3>Verify and remove permissions</h3>
      <p>To check existing permissions and remove them when needed:</p>
      
      <div class="code-container">
        <div class="code-header">
          <span class="code-language">PowerShell</span>
          <button class="copy-btn" onclick="copyCode(this)">
            <i data-feather="copy" class="w-4 h-4"></i>
            <span>Copy</span>
          </button>
        </div>
        <pre><code class="language-powershell"># List current permissions
Get-MailboxFolderPermission -Identity 'alice@contoso.com:\Calendar'

# Remove a specific permission
Remove-MailboxFolderPermission -Identity 'alice@contoso.com:\Calendar' -User 'bob@contoso.com' -Confirm:$false</code></pre>
      </div>

      <h3>Common Access Rights</h3>
      <p>Here are the most commonly used access rights for calendar permissions:</p>
      <ul>
        <li><strong>Reviewer</strong>: Read-only access to calendar items</li>
        <li><strong>Editor</strong>: Read, create, modify, and delete calendar items</li>
        <li><strong>Author</strong>: Read, create, and modify own calendar items</li>
        <li><strong>Owner</strong>: Full access including permission management</li>
        <li><strong>FreeBusyTimeOnly</strong>: Can only see free/busy time</li>
        <li><strong>FreeBusyTimeAndSubjectAndLocation</strong>: Can see free/busy, subject, and location</li>
      </ul>

      <h3>Best Practices & Notes</h3>
      <ul>
        <li>Always test permissions on a small set of mailboxes before bulk operations</li>
        <li>Use <code>-WhatIf</code> parameter when available to preview changes</li>
        <li>For modern Graph-based automation, consider using Microsoft Graph APIs</li>
        <li>Document permission changes for compliance and auditing purposes</li>
        <li>Regular permission audits help maintain security hygiene</li>
        <li>Consider using security groups instead of individual users for easier management</li>
      </ul>

      <div class="bg-amber-900/30 border border-amber-600/50 rounded-lg p-4 mt-6">
        <div class="flex items-start gap-3">
          <i data-feather="alert-triangle" class="w-5 h-5 text-amber-400 mt-0.5"></i>
          <div>
            <h4 class="text-amber-200 font-semibold mb-1">Important Security Note</h4>
            <p class="text-amber-100 text-sm">Always follow the principle of least privilege when granting calendar permissions. Regularly audit and review permissions to ensure they remain appropriate and necessary.</p>
          </div>
        </div>
      </div>
    </article>

    <!-- Navigation -->
    <div class="mt-12 flex justify-between items-center bg-white/10 backdrop-blur-sm rounded-lg p-6 border border-white/20">
      <a href="../index.html" class="flex items-center gap-2 text-emerald-200 hover:text-white transition-colors">
        <i data-feather="arrow-left" class="w-4 h-4"></i>
        <span>Back to Exchange Posts</span>
      </a>
      <a href="../../../index.html" class="flex items-center gap-2 text-emerald-200 hover:text-white transition-colors">
        <span>View All Posts</span>
        <i data-feather="arrow-right" class="w-4 h-4"></i>
      </a>
    </div>
  </main>

  <!-- Footer -->
  <footer class="text-center p-8 text-emerald-100/70 border-t border-white/10 mt-12">
    <p>© 2025 Sam Adhikari • Cloud Solutions Specialist</p>
  </footer>

  <script>
    // Initialize Feather icons
    feather.replace();

    // Copy code functionality
    function copyCode(button) {
      const codeBlock = button.closest('.code-container').querySelector('code');
      const text = codeBlock.textContent;
      
      navigator.clipboard.writeText(text).then(() => {
        const originalText = button.innerHTML;
        button.innerHTML = '<i data-feather="check" class="w-4 h-4"></i><span>Copied!</span>';
        button.classList.add('copied');
        
        setTimeout(() => {
          button.innerHTML = originalText;
          button.classList.remove('copied');
          feather.replace();
        }, 2000);
      });
    }

    // Enhanced code highlighting
    Prism.highlightAll();
  </script>
</body>
</html>
